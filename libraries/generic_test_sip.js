"use strict";
;
function setdestination(session, event, localParams) {
    var viasource = event.SIP["message"]["body"][0];
    var tmp = viasource.split('Via:')[1];
    var tmp2 = tmp.split('\r\n')[0];
    tmp = tmp2.split(',').pop();
    tmp2 = tmp.split(' ').pop();
    session.source_inviteip = tmp2.split(':')[0];
    session.destination_inviteip = session.source_inviteip;
    session.destination_inviteport = "5062";
    session.destination = "sip:1000001@" + session.destination_inviteip + ":" + session.destination_inviteport;
}
function justproxy(session, event, localParams) {
    setdestination(session, event, localParams);
    session.destination = "sip:1000001@" + session.destination_inviteip + ":" + session.destination_inviteport;
}
function addheader(session, event, localParams) {
    var addHeaders = [];
    var removeHeaders = [];
    setdestination(session, event, localParams);
    session.destination = "sip:1000002@" + session.destination_inviteip + ":" + session.destination_inviteport;
    var hi = {};
    hi.header = "History-Info";
    hi.value = "sip:+11004366087962011@172.20.208.99;user=phone";
    var addHistoryInfo = [];
    addHistoryInfo.push(hi);
    addHeaders.push(addHistoryInfo[0]);
    var niceheader = {};
    niceheader.header = "MyNewHeader";
    niceheader.value = "whateveryoulike";
    addHeaders.push(niceheader);
    session.addHeaders = JSON.stringify(addHeaders);
    removeHeaders.push("Subject");
    session.removeHeaders = JSON.stringify(removeHeaders);
    session.headerrulesselect = "SipServiceSpecificRulesSet";
    return "success";
}
function b2bualeave(session, event, localParams) {
    setdestination(session, event, localParams);
    session.destination = "sip:1000006@" + session.destination_inviteip + ":" + session.destination_inviteport;
}
function setPreconditionForwadCallb2b(session, event, localParams) {
    var ret;
    ret = ret || {};
    ret.resultCode = "success";
    var events;
    events = events || {};
    events.SIPPollEvent = "null";
    events.SIP18xInformatoinalEvent = "null";
    events.SdpAnswerEvent = "null";
    events.SIPReINVITEEvent = "null";
    events.SDPOfferPollEvent = "null";
    events.SipRingingPollEvent = "null";
    events.SipSdpOfferPollEvent = "null";
    events.SIPegClosedEvent = "null";
    events.CallBeingForwardedPollEvent = "null";
    events.SIPSdpAnswerPollEvent = "null";
    events.RingingPollEvent = "null";
    events.SIP18xAnswerEvent = "null";
    events.SIPRingingPollEvent = "null";
    events.InfoPollEvent = "null";
    events.SuccessResponsePollEvent = "null";
    events.RawContentPollEvent = "test/test";
    session.events = JSON.stringify(events);
    var headerVars;
    headerVars = headerVars || {};
    headerVars.disableSendDefaultReason = "Disabled";
    headerVars.disableSendNoAnswerReason = "Disabled";
    session.headerrulevar = JSON.stringify(headerVars);
    session.headerrulesselect = "SipServiceSpecificRulesSet";
    return ret;
}
function checkSDPAnswerAction(session, event, localParams) {
    var eventData = localParams.message;
    var pollAction;
    pollAction = pollAction || {};
    pollAction.type = CallPollActionType.Reject;
    session.sendAction = JSON.stringify(pollAction);
    return true;
}
function storeInitialInvite(session, event, localParams) {
    var initialMsg = localParams.message;
    session.initial = initialMsg;
    return "stored";
}
function modifydisposition(session, event, localParams) {
    var initialMsg = localParams.message;
    if (initialMsg["SIP"]["capabilities"] != null) {
        if (initialMsg["SIP"]["capabilities"].indexOf(Capabilities.FORKING) > -1) {
            var capabilities = [];
            session.upstreamCapabilities = JSON.stringify(capabilities);
        }
    }
    if (initialMsg["SIP"]["R-URI"]["value"] == "sip:972000019@172.31.11.142:5062") {
        session.destlist = ["sip:9900004@172.31.11.142:5062", "sip:9900099@172.31.11.142:5062"];
    }
    return true;
}
function setdestinationlist(session, event, localParams) {
    var initialMsg = localParams.message;
    if (initialMsg["SIP"]["R-URI"]["value"] == "sip:972000019@172.31.11.142:5062") {
        session.destlist = ["sip:9900011@172.31.11.142:5062", "sip:9900022@172.31.11.142:5064", "sip:9900033@172.31.11.142:5065"];
    }
    return true;
}
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoibW9kdWxlLmpzIiwic291cmNlUm9vdCI6IiIsInNvdXJjZXMiOlsibW9kdWxlLnRzIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiI7QUFDQSxDQUFDO0FBQ0QsU0FBUyxjQUFjLENBQUMsT0FBYSxFQUFFLEtBQVcsRUFBRSxXQUFnQjtJQUNoRSxJQUFJLFNBQVMsR0FBRSxLQUFLLENBQUMsR0FBRyxDQUFDLFNBQVMsQ0FBQyxDQUFDLE1BQU0sQ0FBQyxDQUFDLENBQUMsQ0FBQyxDQUFDO0lBQy9DLElBQUksR0FBRyxHQUFDLFNBQVMsQ0FBQyxLQUFLLENBQUMsTUFBTSxDQUFDLENBQUMsQ0FBQyxDQUFDLENBQUM7SUFDbkMsSUFBSSxJQUFJLEdBQUMsR0FBRyxDQUFDLEtBQUssQ0FBQyxNQUFNLENBQUMsQ0FBQyxDQUFDLENBQUMsQ0FBQztJQUU5QixHQUFHLEdBQUMsSUFBSSxDQUFDLEtBQUssQ0FBQyxHQUFHLENBQUMsQ0FBQyxHQUFHLEVBQUUsQ0FBQztJQUUxQixJQUFJLEdBQUMsR0FBRyxDQUFDLEtBQUssQ0FBQyxHQUFHLENBQUMsQ0FBQyxHQUFHLEVBQUUsQ0FBQztJQUMxQixPQUFPLENBQUMsZUFBZSxHQUFDLElBQUksQ0FBQyxLQUFLLENBQUMsR0FBRyxDQUFDLENBQUMsQ0FBQyxDQUFDLENBQUM7SUFDM0MsT0FBTyxDQUFDLG9CQUFvQixHQUFDLE9BQU8sQ0FBQyxlQUFlLENBQUM7SUFDckQsT0FBTyxDQUFDLHNCQUFzQixHQUFDLE1BQU0sQ0FBQztJQUV0QyxPQUFPLENBQUMsV0FBVyxHQUFDLGNBQWMsR0FBRyxPQUFPLENBQUMsb0JBQW9CLEdBQUcsR0FBRyxHQUFHLE9BQU8sQ0FBQyxzQkFBc0IsQ0FBQztBQUU3RyxDQUFDO0FBRUQsU0FBUyxTQUFTLENBQUMsT0FBYSxFQUFFLEtBQVcsRUFBRSxXQUFnQjtJQUMzRCxjQUFjLENBQUMsT0FBTyxFQUFDLEtBQUssRUFBQyxXQUFXLENBQUMsQ0FBQztJQUUxQyxPQUFPLENBQUMsV0FBVyxHQUFDLGNB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Q0FBQztBQUdELFNBQVMsaUJBQWlCLENBQUMsT0FBVyxFQUFDLEtBQVMsRUFBQyxXQUFlO0lBQzVELElBQUksVUFBVSxHQUFHLFdBQVcsQ0FBQyxPQUFPLENBQUM7SUFDckMsSUFBSSxVQUFVLENBQUMsS0FBSyxDQUFDLENBQUMsY0FBYyxDQUFDLElBQUksSUFBSSxFQUFFO1FBQzNDLElBQUksVUFBVSxDQUFDLEtBQUssQ0FBQyxDQUFDLGNBQWMsQ0FBQyxDQUFDLE9BQU8sQ0FBQyxZQUFZLENBQUMsT0FBTyxDQUFDLEdBQUcsQ0FBQyxDQUFDLEVBQUU7WUFFdEUsSUFBSSxZQUFZLEdBQVcsRUFBRSxDQUFDO1lBUTlCLE9BQU8sQ0FBQyxvQkFBb0IsR0FBRyxJQUFJLENBQUMsU0FBUyxDQUFDLFlBQVksQ0FBQyxDQUFDO1NBQy9EO0tBQ0o7SUFFRCxJQUFJLFVBQVUsQ0FBQyxLQUFLLENBQUMsQ0FBQyxPQUFPLENBQUMsQ0FBQyxPQUFPLENBQUMsSUFBSSxrQ0FBa0MsRUFBRTtRQUMzRSxPQUFPLENBQUMsUUFBUSxHQUFHLENBQUMsZ0NBQWdDLEVBQUUsZ0NBQWdDLENBQUMsQ0FBQztLQUMzRjtJQUdELE9BQU8sSUFBSSxDQUFDO0FBQ2hCLENBQUM7QUFHRCxTQUFTLGtCQUFrQixDQUFDLE9BQVcsRUFBQyxLQUFTLEVBQUMsV0FBZTtJQUM3RCxJQUFJLFVBQVUsR0FBRyxXQUFXLENBQUMsT0FBTyxDQUFDO0lBRXJDLElBQUksVUFBVSxDQUFDLEtBQUssQ0FBQyxDQUFDLE9BQU8sQ0FBQyxDQUFDLE9BQU8sQ0FBQyxJQUFJLGtDQUFrQyxFQUFFO1FBQzNFLE9BQU8sQ0FBQyxRQUFRLEdBQUcsQ0FBQyxnQ0FBZ0MsRUFBRSxnQ0FBZ0MsRUFBRSxnQ0FBZ0MsQ0FBQyxDQUFDO0tBQzdIO0lBRUQsT0FBTyxJQUFJLENBQUM7QUFDaEIsQ0FBQyIsInNvdXJjZXNDb250ZW50IjpbIi8vTUFJTkJMT0NLXG47XHJcbmZ1bmN0aW9uIHNldGRlc3RpbmF0aW9uKHNlc3Npb24gOiBhbnksIGV2ZW50IDogYW55LCBsb2NhbFBhcmFtczogYW55ICl7XHJcbiAgICBsZXQgdmlhc291cmNlPSBldmVudC5TSVBbXCJtZXNzYWdlXCJdW1wiYm9keVwiXVswXTtcclxuICAgIGxldCB0bXA9dmlhc291cmNlLnNwbGl0KCdWaWE6JylbMV07XHJcbiAgICBsZXQgdG1wMj10bXAuc3BsaXQoJ1xcclxcbicpWzBdO1xyXG4gICAgLy90bXAyIGlzIG5vdyBhbGwgdmlhXHJcbiAgICB0bXA9dG1wMi5zcGxpdCgnLCcpLnBvcCgpO1xyXG4gICAgLy90bXAgaXMgbm93IGxhc3QgdmlhIHRoYXQgaXMgdGhlIHNvdXJjZWlwIChwbHVzIHByZSBhbmQgcG9ydCBhdCBlbmQpIG9mIHNpcHBcclxuICAgIHRtcDI9dG1wLnNwbGl0KCcgJykucG9wKCk7ICAgIFxyXG4gICAgc2Vzc2lvbi5zb3VyY2VfaW52aXRlaXA9dG1wMi5zcGxpdCgnOicpWzBdO1xyXG4gICAgc2Vzc2lvbi5kZXN0aW5hdGlvbl9pbnZpdGVpcD1zZXNzaW9uLnNvdXJjZV9pbnZpdGVpcDtcclxuICAgIHNlc3Npb24uZGVzdGluYXRpb25faW52aXRlcG9ydD1cIjUwNjJcIjtcclxuXHJcbiAgICBzZXNzaW9uLmRlc3RpbmF0aW9uPVwic2lwOjEwMDAwMDFAXCIgKyBzZXNzaW9uLmRlc3RpbmF0aW9uX2ludml0ZWlwICsgXCI6XCIgKyBzZXNzaW9uLmRlc3RpbmF0aW9uX2ludml0ZXBvcnQ7XHJcblxyXG59XHJcblxyXG5mdW5jdGlvbiBqdXN0cHJveHkoc2Vzc2lvbiA6IGFueSwgZXZlbnQgOiBhbnksIGxvY2FsUGFyYW1zOiBhbnkgKXtcclxuICAgIHNldGRlc3RpbmF0aW9uKHNlc3Npb24sZXZlbnQsbG9jYWxQYXJhbXMpO1xyXG5cclxuICAgIHNlc3Npb24uZGVzdGluYXRpb249XCJzaXA6MTAwMDAwMUBcIiArIHNlc3Npb24uZGVzdGluYXRpb25faW52aXRlaXAgKyBcIjpcIiArIHNlc3Npb24uZGVzdGluYXRpb25faW52aXRlcG9ydDtcclxuXHJcbn1cclxuXHJcbmZ1bmN0aW9uIGFkZGhlYWRlcihzZXNzaW9uIDogYW55LCBldmVudCA6IGFueSwgbG9jYWxQYXJhbXM6IGFueSApeyAgICBcclxuICAgIFxyXG4gICAgbGV0IGFkZEhlYWRlcnMgPSBbXTtcclxuICAgIGxldCByZW1vdmVIZWFkZXJzID0gW107XHJcblxyXG4gICAgLy9nZXQgYW5kIHNldCBkZXN0aW5hdGlvbiBcclxuICAgIHNldGRlc3RpbmF0aW9uKHNlc3Npb24sZXZlbnQsbG9jYWxQYXJhbXMpO1xyXG4gICAgc2Vzc2lvbi5kZXN0aW5hdGlvbj1cInNpcDoxMDAwMDAyQFwiICsgc2Vzc2lvbi5kZXN0aW5hdGlvbl9pbnZpdGVpcCArIFwiOlwiICsgc2Vzc2lvbi5kZXN0aW5hdGlvbl9pbnZpdGVwb3J0O1xyXG5cclxuICAgIC8vYWRkIGhpc3RvcnktaW5mbyBoZWFkZXJcclxuICAgIGxldCBoaTogSGVhZGVyID0ge307XHJcbiAgICBoaS5oZWFkZXIgPSBcIkhpc3RvcnktSW5mb1wiO1xyXG4gICAgaGkudmFsdWUgPSBcInNpcDorMTEwMDQzNjYwODc5NjIwMTFAMTcyLjIwLjIwOC45OTt1c2VyPXBob25lXCI7XHJcbiAgICBsZXQgYWRkSGlzdG9yeUluZm8gPSBbXTtcclxuICAgIGFkZEhpc3RvcnlJbmZvLnB1c2goaGkpO1xyXG4gICAgYWRkSGVhZGVycy5wdXNoKGFkZEhpc3RvcnlJbmZvWzBdKTtcclxuICAgIC8vYWRkIDJuZCBoZWFkZXJcclxuICAgIGxldCBuaWNlaGVhZGVyOiBIZWFkZXIgPSB7fTtcclxuICAgIG5pY2VoZWFkZXIuaGVhZGVyID0gXCJNeU5ld0hlYWRlclwiO1xyXG4gICAgbmljZWhlYWRlci52YWx1ZSA9IFwid2hhdGV2ZXJ5b3VsaWtlXCI7XHJcbiAgICBhZGRIZWFkZXJzLnB1c2gobmljZWhlYWRlcik7XHJcbiAgICAvL2lmIGFsbCBoZWFkZXJzIGFyZSBhZGRlZCAtIGFkZCB0byBzZXNzaW9uIFxyXG4gICAgc2Vzc2lvbi5hZGRIZWFkZXJzID0gSlNPTi5zdHJpbmdpZnkoYWRkSGVhZGVycyk7XHJcblxyXG4gICAgLy9ub3cgcmVtb3ZlIGEgaGVhZGVyXHJcbiAgICByZW1vdmVIZWFkZXJzLnB1c2goXCJTdWJqZWN0XCIpO1xyXG4gICAgc2Vzc2lvbi5yZW1vdmVIZWFkZXJzID0gSlNPTi5zdHJpbmdpZnkocmVtb3ZlSGVhZGVycyk7XHJcblxyXG4gICAgLy9TZXQgaGVhZGVycyBmb3Igb3V0Z29pbmcgbWVzc2FnZVxyXG4gICAgLy9sZXQgaGVhZGVyVmFycyA6IEhlYWRlclZhcnM7XHJcbiAgICAvL2hlYWRlclZhcnMgPSBoZWFkZXJWYXJzIHx8IHt9O1xyXG4gICAgLy9oZWFkZXJWYXJzLmRpc2FibGVTZW5kRGVmYXVsdFJlYXNvbiA9IFwiRGlzYWJsZWRcIjtcclxuICAgIC8vaGVhZGVyVmFycy5kaXNhYmxlU2VuZE5vQW5zd2VyUmVhc29uID0gXCJEaXNhYmxlZFwiOyAgICBcclxuICAgIC8vc2Vzc2lvbi5oZWFkZXJydWxldmFyPUpTT04uc3RyaW5naWZ5KGhlYWRlclZhcnMpO1xyXG4gICAgXHJcbiAgICAvL3NlbGVjdCBoZWFkZXIgcnVsZSBzZXQgaW4gVEFTIGZvciBwcm94eS9iMmJ1YSBzY2VuYXJpb3NcclxuICAgIHNlc3Npb24uaGVhZGVycnVsZXNzZWxlY3QgPSBcIlNpcFNlcnZpY2VTcGVjaWZpY1J1bGVzU2V0XCI7XHJcblxyXG4gICAgLy8gc2Vzc2lvbi5yaW5naW5ndG9uZXMgPSBKU09OLnN0cmluZ2lmeShyaW5naW5nVG9uZXMpO1xyXG5cclxuICAgIC8vbGV0IGV2ZW50cyA6IEV2ZW50cztcclxuICAgIC8vZXZlbnRzID0gZXZlbnRzIHx8IHt9O1xyXG4gICAgLy9ldmVudHMuSW5mb1BvbGxFdmVudD1cIm51bGxcIjtcclxuICAgIC8vZXZlbnRzLlN1Y2Nlc3NSZXNwb25zZVBvbGxFdmVudD1cIm51bGxcIjtcclxuICAgIC8vZXZlbnRzLlNJUFJpbmdpbmdQb2xsRXZlbnQ9XCJudWxsXCI7XHJcbiAgICAvL2V2ZW50cy5SYXdDb250ZW50UG9sbEV2ZW50PVwidGVzdC90ZXN0XCI7XHJcbiAgICAvL3Nlc3Npb24uZXZlbnRzID0gSlNPTi5zdHJpbmdpZnkoZXZlbnRzKTtcclxuICAgXHJcblxyXG4gICAgLy9sZXQgdW5zdWIgPSB7XCJJbmZvUG9sbEV2ZW50XCI6XCJcIiwgXCJTdWNjZXNzUmVzcG9uc2VQb2xsRXZlbnRcIjpcIlwiLCBcIlNJUFJpbmdpbmdQb2xsRXZlbnRcIjpcIlwiLCBcIlJhd0NvbnRlbnRQb2xsRXZlbnRcIjpcIlwifTtcclxuICAgIC8vc2Vzc2lvbi51bnN1YnNjcmliZUV2ZW50cz1KU09OLnN0cmluZ2lmeSh1bnN1Yik7XHJcbiAgICAvL2xldCB1bnN1YiA9IHtcIlNJUDE4eEFuc3dlckV2ZW50XCI6XCJcIn07XHJcbiAgICAvL3Nlc3Npb24udW5zdWJzY3JpYmVFdmVudHM9SlNPTi5zdHJpbmdpZnkodW5zdWIpOyAgICBcclxuXHJcblxyXG4gICAgLy9TcGVjaWZ5IHRoZSBNb2RlIGZvciB0aGUgU05GLCBzbyBTTkYgYWRkcyBpdHNlbGYgdG8gUmVjb3JkLVJvdXRlIChuZWVkZWQgZm9yIGIyYnVhKSBvciBub3QgKHByb3h5KVxyXG4gICAgLy9oZWFkZXJWYXJzLnByaXZhdGVTZXJ2aWNlTW9kZSA9IHNlc3Npb24uc19Qcml2YXRlU2VydmljZU1vZGU7XHJcblxyXG4gICAgLyogICAgICAgIFxyXG4gICAgbGV0IGNhcGFiaWxpdGllcyA6IGFueVtdID0gW107XHJcbiAgICBjYXBhYmlsaXRpZXMucHVzaChDYXBhYmlsaXRpZXMuUEVNKTtcclxuICAgIGNhcGFiaWxpdGllcy5wdXNoKENhcGFiaWxpdGllcy5SRUwxWFgpO1xyXG4gICAgY2FwYWJpbGl0aWVzLnB1c2goQ2FwYWJpbGl0aWVzLlVQREFURSk7XHJcbiAgICBjYXBhYmlsaXRpZXMucHVzaChDYXBhYmlsaXRpZXMuRk9SS0lORyk7XHJcbiAgICAvL3Nlc3Npb24udXBzdHJlYW1DYXBhYmlsaXRpZXMgPSBKU09OLnN0cmluZ2lmeShjYXBhYmlsaXRpZXMpO1xyXG4gICAgKi9cclxuICAgIC8vc2V0IHRoZSBhY3Rpb24gZm9yIHRoZSBjYWxsIFxyXG4gICAgLy9sZXQgcG9sbEFjdGlvbiA6IENhbGxQb2xsQWN0aW9uID0ge307XHJcbiAgICAvL3BvbGxBY3Rpb24udHlwZSA9IGFjdGlvblR5cGU7XHJcbiAgICAvL3Nlc3Npb24uc2VuZEFjdGlvbiA9IEpTT04uc3RyaW5naWZ5KHBvbGxBY3Rpb24pO1xyXG5cclxuICAgIHJldHVybiBcInN1Y2Nlc3NcIjtcclxufVxyXG5cclxuZnVuY3Rpb24gYjJidWFsZWF2ZShzZXNzaW9uIDogYW55LCBldmVudCA6IGFueSwgbG9jYWxQYXJhbXM6IGFueSApe1xyXG4gICAgc2V0ZGVzdGluYXRpb24oc2Vzc2lvbixldmVudCxsb2NhbFBhcmFtcyk7XHJcblxyXG4gICAgc2Vzc2lvbi5kZXN0aW5hdGlvbj1cInNpcDoxMDAwMDA2QFwiICsgc2Vzc2lvbi5kZXN0aW5hdGlvbl9pbnZpdGVpcCArIFwiOlwiICsgc2Vzc2lvbi5kZXN0aW5hdGlvbl9pbnZpdGVwb3J0O1xyXG5cclxufVxyXG5cclxuZnVuY3Rpb24gc2V0UHJlY29uZGl0aW9uRm9yd2FkQ2FsbGIyYihzZXNzaW9uOmFueSxldmVudDphbnksbG9jYWxQYXJhbXM6YW55KTogUmVzdWx0Q29kZSB7XHJcblxyXG4gICAgbGV0IHJldDogUmVzdWx0Q29kZSA7XHJcbiAgICByZXQgPSByZXQgfHwge307XHJcbiAgICByZXQucmVzdWx0Q29kZT1cInN1Y2Nlc3NcIjtcclxuICAgIFxyXG4gICAgbGV0IGV2ZW50cyA6IEV2ZW50cztcclxuICAgIGV2ZW50cyA9IGV2ZW50cyB8fCB7fTtcclxuXHJcbiAgICBcclxuICAgIGV2ZW50cy5TSVBQb2xsRXZlbnQ9XCJudWxsXCI7XHJcbiAgICAvL3R5cG9zIGluIHRoZSBiZWxvd1xyXG4gICAgZXZlbnRzLlNJUDE4eEluZm9ybWF0b2luYWxFdmVudD1cIm51bGxcIjtcclxuICAgIGV2ZW50cy5TZHBBbnN3ZXJFdmVudD1cIm51bGxcIjtcclxuICAgIGV2ZW50cy5TSVBSZUlOVklURUV2ZW50PVwibnVsbFwiO1xyXG4gICAgZXZlbnRzLlNEUE9mZmVyUG9sbEV2ZW50PVwibnVsbFwiO1xyXG4gICAgZXZlbnRzLlNpcFJpbmdpbmdQb2xsRXZlbnQ9XCJudWxsXCI7XHJcbiAgICBldmVudHMuU2lwU2RwT2ZmZXJQb2xsRXZlbnQ9XCJudWxsXCI7XHJcbiAgICBldmVudHMuU0lQZWdDbG9zZWRFdmVudD1cIm51bGxcIjtcclxuICAgIFxyXG4gICAgZXZlbnRzLkNhbGxCZWluZ0ZvcndhcmRlZFBvbGxFdmVudD1cIm51bGxcIjtcclxuICAgIGV2ZW50cy5TSVBTZHBBbnN3ZXJQb2xsRXZlbnQ9XCJudWxsXCI7XHJcblxyXG4gICAgZXZlbnRzLlJpbmdpbmdQb2xsRXZlbnQ9XCJudWxsXCI7XHJcblxyXG5cclxuXHJcblxyXG4gICAgZXZlbnRzLlNJUDE4eEFuc3dlckV2ZW50PVwibnVsbFwiO1xyXG4gICAgZXZlbnRzLlNJUFJpbmdpbmdQb2xsRXZlbnQ9XCJudWxsXCI7XHJcbiAgICAvL25lZWRzIGEgaGFuZGxlXHJcbiAgICBldmVudHMuSW5mb1BvbGxFdmVudD1cIm51bGxcIjtcclxuICAgIGV2ZW50cy5TdWNjZXNzUmVzcG9uc2VQb2xsRXZlbnQ9XCJudWxsXCI7XHJcbiAgICBldmVudHMuUmF3Q29udGVudFBvbGxFdmVudD1cInRlc3QvdGVzdFwiO1xyXG4gICAgc2Vzc2lvbi5ldmVudHMgPSBKU09OLnN0cmluZ2lmeShldmVudHMpOyAgXHJcblxyXG4gICAgLy9sZXQgdW5zdWIgPSB7XCJJbmZvUG9sbEV2ZW50XCI6XCJcIiwgXCJTdWNjZXNzUmVzcG9uc2VQb2xsRXZlbnRcIjpcIlwiLCBcIlNJUFJpbmdpbmdQb2xsRXZlbnRcIjpcIlwiLCBcIlJhd0NvbnRlbnRQb2xsRXZlbnRcIjpcIlwifTtcclxuICAgIC8vc2Vzc2lvbi51bnN1YnNjcmliZUV2ZW50cz1KU09OLnN0cmluZ2lmeSh1bnN1Yik7XHJcbiAgICAvL2xldCB1bnN1YiA9IHtcIlNJUDE4eEFuc3dlckV2ZW50XCI6XCJcIn07XHJcbiAgICAvL3Nlc3Npb24udW5zdWJzY3JpYmVFdmVudHM9SlNPTi5zdHJpbmdpZnkodW5zdWIpO1xyXG5cclxuICAgIC8vU2V0IGhlYWRlcnMgZm9yIG91dGdvaW5nIG1lc3NhZ2VcclxuICAgIGxldCBoZWFkZXJWYXJzIDogSGVhZGVyVmFycztcclxuICAgIGhlYWRlclZhcnMgPSBoZWFkZXJWYXJzIHx8IHt9O1xyXG4gICAgaGVhZGVyVmFycy5kaXNhYmxlU2VuZERlZmF1bHRSZWFzb24gPSBcIkRpc2FibGVkXCI7XHJcbiAgICBoZWFkZXJWYXJzLmRpc2FibGVTZW5kTm9BbnN3ZXJSZWFzb24gPSBcIkRpc2FibGVkXCI7XHJcbiAgICBzZXNzaW9uLmhlYWRlcnJ1bGV2YXI9SlNPTi5zdHJpbmdpZnkoaGVhZGVyVmFycyk7XHJcbiAgICBzZXNzaW9uLmhlYWRlcnJ1bGVzc2VsZWN0ID0gXCJTaXBTZXJ2aWNlU3BlY2lmaWNSdWxlc1NldFwiO1xyXG5cclxuICAgIC8vU3BlY2lmeSB0aGUgTW9kZSBmb3IgdGhlIFNORiwgc28gU05GIGFkZHMgaXRzZWxmIHRvIFJlY29yZC1Sb3V0ZSAobmVlZGVkIGZvciBiMmJ1YSkgb3Igbm90IChwcm94eSlcclxuICAgIC8vbm90IG5lZWRlZCBoZXJlIC0gdGhpcyBpcyBpbiBTTkYgdG8gYXBwbHkgc29tZSBydWxlcyBmb3IgYjJiXHJcbiAgICAvL2hlYWRlclZhcnMucHJpdmF0ZVNlcnZpY2VNb2RlID0gXCJiMmJ1YVwiXCI7XHJcbiAgICBcclxuICAgIC8qXHJcbiAgICAvL3RoaXMgcmVxdWlyZXMgYSBTdXBwb3J0ZWQ6IDEwMFJlbCBpbiB0aGUgaW5jb21pbmcgcmVxdWVzdCBhbmQgc2VuZHMgYSAxODMgdG8gQSB3aXRoIFJlcXVpcmU6IDEwMFJlbCBcclxuICAgIGxldCBjYXBhYmlsaXRpZXMgOiBhbnlbXSA9IFtdO1xyXG4gICAgY2FwYWJpbGl0aWVzLnB1c2goQ2FwYWJpbGl0aWVzLlBFTSk7XHJcbiAgICBjYXBhYmlsaXRpZXMucHVzaChDYXBhYmlsaXRpZXMuUkVMMVhYKTtcclxuICAgIGNhcGFiaWxpdGllcy5wdXNoKENhcGFiaWxpdGllcy5VUERBVEUpO1xyXG4gICAgY2FwYWJpbGl0aWVzLnB1c2goQ2FwYWJpbGl0aWVzLkZPUktJTkcpO1xyXG4gICAgc2Vzc2lvbi51cHN0cmVhbUNhcGFiaWxpdGllcyA9IEpTT04uc3RyaW5naWZ5KGNhcGFiaWxpdGllcyk7XHJcbiAgICAqL1xyXG5cclxuICAgIC8qXHJcbiAgICBsZXQgY2FwYWJpbGl0aWVzID0gc2Vzc2lvbi5zX0luaXRpYWxDYXBhYmlsaXRpZXM7XHJcbiAgICBpZiggY2FwYWJpbGl0aWVzIT1udWxsKXtcclxuICAgICAgICBjYXBhYmlsaXRpZXMucHVzaChDYXBhYmlsaXRpZXMuUEVNKTtcclxuICAgICAgICBjYXBhYmlsaXRpZXMucHVzaChDYXBhYmlsaXRpZXMuRk9SS0lORyk7XHJcbiAgICAgICAgc2Vzc2lvbi5vdXRDYXBhYmlsaXRpZXMgPSBKU09OLnN0cmluZ2lmeShjYXBhYmlsaXRpZXMpO1xyXG4gICAgfVxyXG4gICAgKi9cclxuXHJcbiAgICAvLyBzZXNzaW9uLnJpbmdpbmd0b25lcyA9IEpTT04uc3RyaW5naWZ5KHJpbmdpbmdUb25lcyk7XHJcblxyXG4gICAgcmV0dXJuIHJldDtcclxufVxyXG5cclxuXHJcbmZ1bmN0aW9uIGNoZWNrU0RQQW5zd2VyQWN0aW9uKHNlc3Npb246YW55LGV2ZW50OmFueSxsb2NhbFBhcmFtczphbnkpICB7XHJcbiAgICAvL2V2ZW50RGF0YSBpcyBub3cgbGFzdCBtZXNzZ2FlXHJcbiAgICBsZXQgZXZlbnREYXRhID0gbG9jYWxQYXJhbXMubWVzc2FnZTtcclxuXHJcbiAgICAvL2FkZCB0aGUgcG9sbCBhY3Rpb25zIChhY2NlcHQsIGZvcndhcmQsIHJlamVjdCkgdG8gdGhlIGNhbGxwb2xsIGFuc2V3ciBldmVudFxyXG4gICAgLy9JbmZvcm1hdGlvbmFsRXZlbnQgaXMgYSBoaWdoLWxldmVsIGludGVyZmFjZSB0eXBpY2FsbHkgc3BlY2lhbGl6ZWQgZm9yIGNvbmNyZXRlIGV2ZW50cy4gVGhlIENhbGxVc2VyIGlzIG5vdCByZXF1aXJlZCB0byB0YWtlIGFueSBhY3Rpb24gZm9yIHRoaXMgZXZlbnQsIHRoZXNlIGFyZSBwdXJlbHkgaW5mb3JtYXRpb25hbC5cclxuICAgIC8vUG9sbEV2ZW50IGlzIGFuIGV2ZW50IG9uIHdoaWNoIHRoZSBDYWxsVXNlciBpcyBleHBlY3RlZCB0byB0YWtlIGFuIGFjdGlvbiB1cG9uIHJlY2VpdmluZyB0aGUgZXZlbnQuIFRoZSBhY3Rpb24gaXMgdXN1YWxseSBieSBpbnZva2luZyB0aGUgUG9sbEV2ZW50IG1ldGhvZHMgYWNjZXB0LCByZWplY3Qgb3IgZm9yd2FyZC5cclxuICAgIGxldCBwb2xsQWN0aW9uIDogQ2FsbFBvbGxBY3Rpb247XHJcbiAgICBwb2xsQWN0aW9uID0gcG9sbEFjdGlvbiB8fCB7fTtcclxuICAgIC8vcG9sbEFjdGlvbi50eXBlID0gQ2FsbFBvbGxBY3Rpb25UeXBlLkFjY2VwdDtcclxuICAgIHBvbGxBY3Rpb24udHlwZSA9IENhbGxQb2xsQWN0aW9uVHlwZS5SZWplY3Q7XHJcbiAgICBzZXNzaW9uLnNlbmRBY3Rpb24gPSBKU09OLnN0cmluZ2lmeShwb2xsQWN0aW9uKTtcclxuXHJcbiAgICByZXR1cm4gdHJ1ZTtcclxufVxyXG5cclxuXHJcbmZ1bmN0aW9uIHN0b3JlSW5pdGlhbEludml0ZShzZXNzaW9uOmFueSxldmVudDphbnksbG9jYWxQYXJhbXM6YW55KSAge1xyXG4gICAgbGV0IGluaXRpYWxNc2cgPSBsb2NhbFBhcmFtcy5tZXNzYWdlO1xyXG4gICAgc2Vzc2lvbi5pbml0aWFsID0gaW5pdGlhbE1zZztcclxuICAgIHJldHVybiBcInN0b3JlZFwiO1xyXG59XHJcblxyXG5cclxuZnVuY3Rpb24gbW9kaWZ5ZGlzcG9zaXRpb24oc2Vzc2lvbjphbnksZXZlbnQ6YW55LGxvY2FsUGFyYW1zOmFueSkge1xyXG4gICAgbGV0IGluaXRpYWxNc2cgPSBsb2NhbFBhcmFtcy5tZXNzYWdlO1xyXG4gICAgaWYgKGluaXRpYWxNc2dbXCJTSVBcIl1bXCJjYXBhYmlsaXRpZXNcIl0gIT0gbnVsbCkge1xyXG4gICAgICAgIGlmIChpbml0aWFsTXNnW1wiU0lQXCJdW1wiY2FwYWJpbGl0aWVzXCJdLmluZGV4T2YoQ2FwYWJpbGl0aWVzLkZPUktJTkcpID4gLTEpIHtcclxuICAgICAgICAgICAgLy9pdCBpcyBwcmVzZW50LiBtZWFucyB0aGUgU0lQIGhlYWRlciBcIlJlcXVlc3QtRGlzcG9zaXRpb246IG5vLWZvcmtcIiBpcyBOT1QgcHJlc2VudC4gVGhpcyBpbnN0cnVjdHMgVEFTIHRvIG5vdCBzZW5kIDE4MyBiZWZvcmUgZm9yd2FyZGluZyB0aGUgSU5WSVRFXHJcbiAgICAgICAgICAgIGxldCBjYXBhYmlsaXRpZXMgOiBhbnlbXSA9IFtdO1xyXG4gICAgICAgICAgICBcclxuICAgICAgICAgICAgLy90aGUgYmVsb3cgY3JlYXRlcyBleGNlcHRpb24gXHJcbiAgICAgICAgICAgIC8vY2FwYWJpbGl0aWVzID0gaW5pdGlhbE1zZy5TSVAuY2FwYWJpbGl0aWVzO1xyXG4gICAgICAgICAgICAvL2NhcGFiaWxpdGllcy5wdXNoKENhcGFiaWxpdGllcy5GT1JLSU5HKTtcclxuICAgICAgICAgICAgLy90aGlzIHdvdWxkIGJlIHJlbW92ZVxyXG4gICAgICAgICAgICAvL2xldCBpbmRleD0gaW5pdGlhbE1zZ1tcIlNJUFwiXVtcImNhcGFiaWxpdGllc1wiXS5pbmRleE9mKENhcGFiaWxpdGllcy5GT1JLSU5HKTtcclxuICAgICAgICAgICAgLy9pbml0aWFsTXNnW1wiU0lQXCJdW1wiY2FwYWJpbGl0aWVzXCJdLnNwbGljZShpbmRleCwgMSk7IC8vIDJuZCBwYXJhbWV0ZXIgbWVhbnMgcmVtb3ZlIG9uZSBpdGVtIG9ubHlcclxuICAgICAgICAgICAgc2Vzc2lvbi51cHN0cmVhbUNhcGFiaWxpdGllcyA9IEpTT04uc3RyaW5naWZ5KGNhcGFiaWxpdGllcyk7ICAgIFxyXG4gICAgICAgIH1cclxuICAgIH1cclxuXHJcbiAgICBpZiAoaW5pdGlhbE1zZ1tcIlNJUFwiXVtcIlItVVJJXCJdW1widmFsdWVcIl0gPT0gXCJzaXA6OTcyMDAwMDE5QDE3Mi4zMS4xMS4xNDI6NTA2MlwiKSB7XHJcbiAgICAgICAgc2Vzc2lvbi5kZXN0bGlzdCA9IFtcInNpcDo5OTAwMDA0QDE3Mi4zMS4xMS4xNDI6NTA2MlwiLCBcInNpcDo5OTAwMDk5QDE3Mi4zMS4xMS4xNDI6NTA2MlwiXTtcclxuICAgIH1cclxuICAgIFxyXG5cclxuICAgIHJldHVybiB0cnVlO1xyXG59XHJcblxyXG5cclxuZnVuY3Rpb24gc2V0ZGVzdGluYXRpb25saXN0KHNlc3Npb246YW55LGV2ZW50OmFueSxsb2NhbFBhcmFtczphbnkpIHtcclxuICAgIGxldCBpbml0aWFsTXNnID0gbG9jYWxQYXJhbXMubWVzc2FnZTtcclxuXHJcbiAgICBpZiAoaW5pdGlhbE1zZ1tcIlNJUFwiXVtcIlItVVJJXCJdW1widmFsdWVcIl0gPT0gXCJzaXA6OTcyMDAwMDE5QDE3Mi4zMS4xMS4xNDI6NTA2MlwiKSB7XHJcbiAgICAgICAgc2Vzc2lvbi5kZXN0bGlzdCA9IFtcInNpcDo5OTAwMDExQDE3Mi4zMS4xMS4xNDI6NTA2MlwiLCBcInNpcDo5OTAwMDIyQDE3Mi4zMS4xMS4xNDI6NTA2NFwiLCBcInNpcDo5OTAwMDMzQDE3Mi4zMS4xMS4xNDI6NTA2NVwiXTtcclxuICAgIH1cclxuICAgIFxyXG4gICAgcmV0dXJuIHRydWU7XHJcbn1cclxuXHJcblxyXG5cclxuIl19