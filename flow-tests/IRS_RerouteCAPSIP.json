{"name":"IRS_RerouteCAPSIP","steps":[{"type":"write","fn":"\n/**\n * Here you can change the event before it is sent using also the state accumulated so far.\n * @param state {Object} state structure, contains at least field session; you can add to it to propagate state from test step to test step\n * @param event {Object} the event to be sent.\n * @return {Object} the event to be sent\n */\nfunction pre_process(state,event){\n  // it does nothing, it is up to you to add some meaningful actions; most likely you want to change the event before being sent\n  // the application adds session field to event automatically, you don't need to add it\n  return event;\n}\n","event":{"event-name":"callStart.NONE","event-label":"h3irs_staging","call":{"legs":[{"name":null,"address":{"scheme":"tel","user":"436608795113","parameters":{"presentation":"0","screening":"1","number-incomplete-ind":"0","network-context":"Q763.4.1"}}},{"name":null,"address":{"scheme":"tel","user":"43660303256","parameters":{"network-context":"TS24008.1.1"}}}],"state":"START"},"as":"tt-b52-vtas3-seese-0003_3","event-additional-info":{"tracingmsg":"IRSbyMOlegUser","tracinglist":"h3irs_staging","dispatcherresult":"stagingset","tracingid":"436608795113","traceIndented":false},"event":{"name":"callStart","callStart":{"cause":"NONE","contact":{"scheme":"tel","user":"43660303256","parameters":{"network-context":"TS24008.1.1"}},"leg":{"scheme":"tel","user":"436608795113","parameters":{"presentation":"0","screening":"1","number-incomplete-ind":"0","network-context":"Q763.4.1"}}},"id":0,"camel":{"networkProtocol":"CAMEL2","locationInformation":"cgid:22210f4e733ebd","charging":{"usedUnits":[{"tariffTimeChange":0,"amount":0,"unit":"TIME_MILLISECONDS","tariffChangeUsage":"NOT_APPLICABLE","direction":"NOT_APPLICABLE","reportingReason":null}]},"gsmFwdPending":false,"vlrAddress":{"scheme":"tel","user":"393492000093","parameters":{"network-context":"TS29002.1.1"}},"cs":{"lastNetworkEvent":2,"tcapEndMode":"PAYLOAD_TC_END","imsi":"232056317208974","disconnectedFlag":false,"extnTeleServiceCode":"11","rawBearerCapability":"8090A3"},"cgPaCategory":10,"sccpCdPa":{"scheme":"gt","user":"436990081523","parameters":{"gt-ind":"4","gt-trans-type":"0","network-context":"Q713.4.1"}},"mscAddress":{"scheme":"tel","user":"393492000093","parameters":{"network-context":"TS29002.1.1"}},"common":{"networkTimeZoneOffSet":0,"callAttemptTime":1719301480903,"networkCallType":"ORIGINATING","mediaType":"AUDIO","callReleaseTime":0,"serviceKey":"20","connectionTimeout":-1,"callConnectedTime":0},"locationNumber":{"scheme":"tel","user":"393492000093","parameters":{"internal-net-number-ind":"1","network-context":"Q763.4.1"}},"sccpCgPa":{"scheme":"gt","user":"393492000093","parameters":{"gt-ind":"4","gt-trans-type":"0","network-context":"Q713.4.1"}},"bearerServiceCode":-1,"eventTypeBCSM":2,"highLayerCharacteristics":37249,"callReferenceNumber":"401E70170695BD"}},"event-label-match":false,"callid":"tt-b52-vtas3-seese-0003_3-1719301480904-CALL-1-AppSess-202","event-type":"camel"},"original-event":{"event-name":"callStart.NONE","event-label":"h3irs_staging","call":{"legs":[{"name":null,"address":{"scheme":"tel","user":"436608795113","parameters":{"presentation":"0","screening":"1","number-incomplete-ind":"0","network-context":"Q763.4.1"}}},{"name":null,"address":{"scheme":"tel","user":"43660303256","parameters":{"network-context":"TS24008.1.1"}}}],"state":"START"},"as":"tt-b52-vtas3-seese-0003_3","event-additional-info":{"tracingmsg":"IRSbyMOlegUser","tracinglist":"h3irs_staging","dispatcherresult":"stagingset","tracingid":"436608795113","traceIndented":false},"event":{"name":"callStart","callStart":{"cause":"NONE","contact":{"scheme":"tel","user":"43660303256","parameters":{"network-context":"TS24008.1.1"}},"leg":{"scheme":"tel","user":"436608795113","parameters":{"presentation":"0","screening":"1","number-incomplete-ind":"0","network-context":"Q763.4.1"}}},"id":0,"camel":{"networkProtocol":"CAMEL2","locationInformation":"cgid:22210f4e733ebd","charging":{"usedUnits":[{"tariffTimeChange":0,"amount":0,"unit":"TIME_MILLISECONDS","tariffChangeUsage":"NOT_APPLICABLE","direction":"NOT_APPLICABLE","reportingReason":null}]},"gsmFwdPending":false,"vlrAddress":{"scheme":"tel","user":"393492000093","parameters":{"network-context":"TS29002.1.1"}},"cs":{"lastNetworkEvent":2,"tcapEndMode":"PAYLOAD_TC_END","imsi":"232056317208974","disconnectedFlag":false,"extnTeleServiceCode":"11","rawBearerCapability":"8090A3"},"cgPaCategory":10,"sccpCdPa":{"scheme":"gt","user":"436990081523","parameters":{"gt-ind":"4","gt-trans-type":"0","network-context":"Q713.4.1"}},"mscAddress":{"scheme":"tel","user":"393492000093","parameters":{"network-context":"TS29002.1.1"}},"common":{"networkTimeZoneOffSet":0,"callAttemptTime":1719301480903,"networkCallType":"ORIGINATING","mediaType":"AUDIO","callReleaseTime":0,"serviceKey":"20","connectionTimeout":-1,"callConnectedTime":0},"locationNumber":{"scheme":"tel","user":"393492000093","parameters":{"internal-net-number-ind":"1","network-context":"Q763.4.1"}},"sccpCgPa":{"scheme":"gt","user":"393492000093","parameters":{"gt-ind":"4","gt-trans-type":"0","network-context":"Q713.4.1"}},"bearerServiceCode":-1,"eventTypeBCSM":2,"highLayerCharacteristics":37249,"callReferenceNumber":"401E70170695BD"}},"event-label-match":false,"callid":"tt-b52-vtas3-seese-0003_3-1719301480904-CALL-1-AppSess-202","event-type":"camel"},"description":"","entry":"callStart.NONE","timestamp":1721994722871,"state":"114","sequence":1,"service":"ocadminv5:h3irs:h3irs_InternationalRoamingService_main","flow":"ocadminv5:h3irs:h3irs_InternationalRoamingService_main"},{"type":"read","fn":"\n/**\n * it is used to implement checks to declare if step was successful or not\n * @param state {Object} state structure, contains at least field session\n * @param event {Object} the event received\n * @return {Boolean} true if step is to be declared successful\n */\nfunction validate(state,event){\n  // it does nothing for now, add your own validation; you have access to state as it was populated from previous steps\n  return true;\n}\n","original-event":{"headers":{"x-fire-and-forget":"no","content-type":"application/json","site-id":"default"},"request-method":"get","body":{"options":{"filter":"(|(romscgt=393492000093)(romscgt=393492000093)(romscgt=39349200009)(romscgt=3934920000)(romscgt=393492000)(romscgt=39349200)(romscgt=3934920)(romscgt=393492)(romscgt=39349)(romscgt=3934)(romscgt=393)(romscgt=39))","time-limit":0,"filter-generator-name":"romscgt","deref":"never","cache-ttl-ms":0,"scope":"one"},"base-dn":"app=mscroaming,dc=apd","hierarchical":"false"},"uri":"/search"},"event":{"headers":{"x-fire-and-forget":"no","content-type":"application/json","site-id":"default"},"request-method":"get","body":{"options":{"filter":"(|(romscgt=393492000093)(romscgt=393492000093)(romscgt=39349200009)(romscgt=3934920000)(romscgt=393492000)(romscgt=39349200)(romscgt=3934920)(romscgt=393492)(romscgt=39349)(romscgt=3934)(romscgt=393)(romscgt=39))","time-limit":0,"filter-generator-name":"romscgt","deref":"never","cache-ttl-ms":0,"scope":"one"},"base-dn":"app=mscroaming,dc=apd","hierarchical":"false"},"uri":"/search"},"description":"LDAP search","entry":"success","timestamp":1721994722879,"state":"342","sequence":5,"service":"ocadminv5:h3irs:h3irs_InternationalRoamingService_main","flow":"ocadminv5:h3irs:h3irs_InternationalRoamingService_main"},{"type":"write","fn":"\n/**\n * Here you can change the event before it is sent using also the state accumulated so far.\n * @param state {Object} state structure, contains at least field session; you can add to it to propagate state from test step to test step\n * @param event {Object} the event to be sent.\n * @return {Object} the event to be sent\n */\nfunction pre_process(state,event){\n  // it does nothing, it is up to you to add some meaningful actions; most likely you want to change the event before being sent\n  // the application adds session field to event automatically, you don't need to add it\n  return event;\n}\n","event":{"event-name":"ldap.status.1000","headers":{"X-LDAP-backend-pool":"sit","Content-Type":"application/json","X-LDAP-site":"default"},"ingress-queue":"h3irs_LdapClientGW_ingress","status":1000,"body":[{"natprefix":"0","ni":"2","objectClass":["mscroaming"],"voicemailflag":"TRUE","continent":"Europe","labapd":"INITLOAD","mscgt":"39349","videomailflag":"FALSE","roampartnername":"Vodafone Italia S.p.A","mccmnc":"22210","CountryCode":"39","latapd":"Updated","selectivererouting":"2","capversion":"2","intprefix":"00","reroutingind":"TRUE","dn":"romscgt=39349,app=mscroaming,dc=apd","lawapd":"1677071944645384","timeoffset":"99","reroutingprefix":"4366030381","romscgt":"39349","optimizedroutingflag":"TRUE","tapcode":"ITAOM"}],"event-type":"ldap"},"original-event":{"event-name":"ldap.status.1000","headers":{"X-LDAP-backend-pool":"sit","Content-Type":"application/json","X-LDAP-site":"default"},"ingress-queue":"h3irs_LdapClientGW_ingress","status":1000,"body":[{"natprefix":"0","ni":"2","objectClass":["mscroaming"],"voicemailflag":"TRUE","continent":"Europe","labapd":"INITLOAD","mscgt":"39349","videomailflag":"FALSE","roampartnername":"Vodafone Italia S.p.A","mccmnc":"22210","CountryCode":"39","latapd":"Updated","selectivererouting":"2","capversion":"2","intprefix":"00","reroutingind":"TRUE","dn":"romscgt=39349,app=mscroaming,dc=apd","lawapd":"1677071944645384","timeoffset":"99","reroutingprefix":"4366030381","romscgt":"39349","optimizedroutingflag":"TRUE","tapcode":"ITAOM"}],"event-type":"ldap"},"description":"handle LDAP","entry":"ldap.status.1000","timestamp":1721994722898,"state":"343","sequence":6,"service":"ocadminv5:h3irs:h3irs_InternationalRoamingService_main","flow":"ocadminv5:h3irs:h3irs_InternationalRoamingService_main"},{"type":"read","fn":"\n/**\n * it is used to implement checks to declare if step was successful or not\n * @param state {Object} state structure, contains at least field session\n * @param event {Object} the event received\n * @return {Boolean} true if step is to be declared successful\n */\nfunction validate(state,event){\n  // it does nothing for now, add your own validation; you have access to state as it was populated from previous steps\n  return true;\n}\n","original-event":{"headers":{"x-fire-and-forget":"no","content-type":"application/json","site-id":"default"},"request-method":"get","body":{"options":{"filter":"(objectClass=*)","time-limit":0,"deref":"always","cache-ttl-ms":0,"scope":"sub"},"base-dn":"amsisdn=436608795113,type=public,type=alias,dc=cpd4","hierarchical":"false"},"uri":"/search"},"event":{"headers":{"x-fire-and-forget":"no","content-type":"application/json","site-id":"default"},"request-method":"get","body":{"options":{"filter":"(objectClass=*)","time-limit":0,"deref":"always","cache-ttl-ms":0,"scope":"sub"},"base-dn":"amsisdn=436608795113,type=public,type=alias,dc=cpd4","hierarchical":"false"},"uri":"/search"},"description":"LDAP search","entry":"success","timestamp":1721994722905,"state":"273","sequence":10,"service":"ocadminv5:h3irs:h3irs_InternationalRoamingService_main","flow":"ocadminv5:h3irs:h3irs_InternationalRoamingService_main"},{"type":"write","fn":"\n/**\n * Here you can change the event before it is sent using also the state accumulated so far.\n * @param state {Object} state structure, contains at least field session; you can add to it to propagate state from test step to test step\n * @param event {Object} the event to be sent.\n * @return {Object} the event to be sent\n */\nfunction pre_process(state,event){\n  // it does nothing, it is up to you to add some meaningful actions; most likely you want to change the event before being sent\n  // the application adds session field to event automatically, you don't need to add it\n  return event;\n}\n","event":{"event-name":"ldap.status.1000","headers":{"X-LDAP-backend-pool":"sit","Content-Type":"application/json","X-LDAP-site":"default"},"ingress-queue":"h3irs_LdapClientGW_ingress","status":1000,"body":[{"vprofile":"VOICEH3APOST","objectClass":["PublicID"],"desc":"ResidentialMSISDN","pidt":"MSISDN","pbt":"POSTPAID","dpcrfp":["DATAH3A","20191015"],"labcpd":"INITLOAD","latcpd":"Added","pimsi":"232149800005113","lawcpd":"1605741898229577","pid":"436608795113","dn":"pid=436608795113,subs=53540422,acct=H3A,dc=cpd4","piccid":"8943052002778015632","pstatus":"ACTIVE"},{"objectClass":["ServiceDATA"],"dsid":"DATA","dn":"dsid=DATA,pid=436608795113,subs=53540422,acct=H3A,dc=cpd4"},{"objectClass":["ServiceDATA"],"dpbcd":"15","dpshthr":"23552","labcpd":"MARTIN","latcpd":"Updated","lawcpd":"1636471938653262","dpsms":"ATO1279","dsid":"20191015","dpqos":"40","dn":"dsid=20191015,dsid=DATA,pid=436608795113,subs=53540422,acct=H3A,dc=cpd4","dsprpid":"182","dpbsu":"20000","dpbsd":"50000"},{"dsf":"BlockMobileTv","objectClass":["ServiceDATA"],"dcpara":"FairUseLimit","dvpnid":"0","labcpd":"INITLOAD","latcpd":"Added","dsip":"0.0.0.0","dctarif":"0","lawcpd":"1605741929356729","dsid":"DATAH3A","dpw":"password","dn":"dsid=DATAH3A,dsid=DATA,pid=436608795113,subs=53540422,acct=H3A,dc=cpd4","dprvd":"2019-10-31"},{"tsdlmccmnc":"23214","objectClass":["TransientData"],"tsdptgysyv":"12941923","tsdlsvtime":"0","tsdpcst":"0","tsdplrvt":"20230322","tsdpsmsnid64":"0","tsdptgyonv":"0","tsdlimei":"8656440602206401","tsdplbrd":"20240715","tsdpsmsntime":"0","tsdcsh":"tt-b52-pcs91-dgw.5gc.mnc014.mcc232.3gppnetwork.org","labcpd":"tt-b52-pcs91-rtea-0001","latcpd":"pcpupdatecounters","lawcpd":"1721994255459","tssysessst":"1721910641752","tsdptgyoffv":"12941923","tsdblob2":"{\"dataProfile\":{\"current\":{\"dpshthr\":\"23552\",\"dsid\":\"20191015\"},\"before\":{\"dpshthr\":\"23552\",\"dsid\":\"20191015\"}},\"Home\":{\"3\":{\"33\":{\"volume\":11879244},\"06\":{\"volume\":1062679}}},\"sy\":{\"Home\":{\"3\":{\"33\":{\"volume\":11879244},\"06\":{\"volume\":1062679}}}}}","dn":"tsdid=1,pid=436608795113,subs=53540422,acct=H3A,dc=cpd4","tsdptgyv":"12941923","tsdid":"1","tsdpuv":"0","tsdlimsi":"232149800005113","tssysessblob2":"{\"msisdn\":{\"436608795113\":{\"slr_type\":0,\"sb_h2h\":1776392593,\"policyCountersJSON\":\"{\\\"8\\\":\\\"\\\"}\",\"sb_queue\":\"none\",\"sb_e2e\":4462258,\"sb_originHost\":\"tt-b52-pcf91\",\"sb_connectionKey\":1,\"sessionId\":\"tt-b52-pcf91;773394225;1333;942;68\",\"sb_originRealm\":\"5gc.mnc014.mcc232.3gppnetwork.org\",\"subscriptionIdMsisdn\":\"436608795113\",\"policyCounters\":{\"8\":\"\"}}}}","tssysessid":"tt-b52-pcf91;773394225;1333;942;68","tsdpcs":"base","tsdlsvev":"0","tsdptgysybasev":"12941923"},{"objectClass":["TransientVoice"],"latcpd":"Added","labcpd":"INITLOAD","dn":"tsvid=1,pid=436608795113,subs=53540422,acct=H3A,dc=cpd4","tsvid":"1","lawcpd":"1605741898275880"},{"objectClass":["ServiceVOICE"],"dn":"vsid=VOICE,pid=436608795113,subs=53540422,acct=H3A,dc=cpd4","vsid":"VOICE"},{"objectClass":["ServiceVOICE"],"latcpd":"Added","labcpd":"INITLOAD","dn":"vsid=VOICEH3APOST,vsid=VOICE,pid=436608795113,subs=53540422,acct=H3A,dc=cpd4","lawcpd":"1605741922904481","vsid":"VOICEH3APOST"}],"event-type":"ldap"},"original-event":{"event-name":"ldap.status.1000","headers":{"X-LDAP-backend-pool":"sit","Content-Type":"application/json","X-LDAP-site":"default"},"ingress-queue":"h3irs_LdapClientGW_ingress","status":1000,"body":[{"vprofile":"VOICEH3APOST","objectClass":["PublicID"],"desc":"ResidentialMSISDN","pidt":"MSISDN","pbt":"POSTPAID","dpcrfp":["DATAH3A","20191015"],"labcpd":"INITLOAD","latcpd":"Added","pimsi":"232149800005113","lawcpd":"1605741898229577","pid":"436608795113","dn":"pid=436608795113,subs=53540422,acct=H3A,dc=cpd4","piccid":"8943052002778015632","pstatus":"ACTIVE"},{"objectClass":["ServiceDATA"],"dsid":"DATA","dn":"dsid=DATA,pid=436608795113,subs=53540422,acct=H3A,dc=cpd4"},{"objectClass":["ServiceDATA"],"dpbcd":"15","dpshthr":"23552","labcpd":"MARTIN","latcpd":"Updated","lawcpd":"1636471938653262","dpsms":"ATO1279","dsid":"20191015","dpqos":"40","dn":"dsid=20191015,dsid=DATA,pid=436608795113,subs=53540422,acct=H3A,dc=cpd4","dsprpid":"182","dpbsu":"20000","dpbsd":"50000"},{"dsf":"BlockMobileTv","objectClass":["ServiceDATA"],"dcpara":"FairUseLimit","dvpnid":"0","labcpd":"INITLOAD","latcpd":"Added","dsip":"0.0.0.0","dctarif":"0","lawcpd":"1605741929356729","dsid":"DATAH3A","dpw":"password","dn":"dsid=DATAH3A,dsid=DATA,pid=436608795113,subs=53540422,acct=H3A,dc=cpd4","dprvd":"2019-10-31"},{"tsdlmccmnc":"23214","objectClass":["TransientData"],"tsdptgysyv":"12941923","tsdlsvtime":"0","tsdpcst":"0","tsdplrvt":"20230322","tsdpsmsnid64":"0","tsdptgyonv":"0","tsdlimei":"8656440602206401","tsdplbrd":"20240715","tsdpsmsntime":"0","tsdcsh":"tt-b52-pcs91-dgw.5gc.mnc014.mcc232.3gppnetwork.org","labcpd":"tt-b52-pcs91-rtea-0001","latcpd":"pcpupdatecounters","lawcpd":"1721994255459","tssysessst":"1721910641752","tsdptgyoffv":"12941923","tsdblob2":"{\"dataProfile\":{\"current\":{\"dpshthr\":\"23552\",\"dsid\":\"20191015\"},\"before\":{\"dpshthr\":\"23552\",\"dsid\":\"20191015\"}},\"Home\":{\"3\":{\"33\":{\"volume\":11879244},\"06\":{\"volume\":1062679}}},\"sy\":{\"Home\":{\"3\":{\"33\":{\"volume\":11879244},\"06\":{\"volume\":1062679}}}}}","dn":"tsdid=1,pid=436608795113,subs=53540422,acct=H3A,dc=cpd4","tsdptgyv":"12941923","tsdid":"1","tsdpuv":"0","tsdlimsi":"232149800005113","tssysessblob2":"{\"msisdn\":{\"436608795113\":{\"slr_type\":0,\"sb_h2h\":1776392593,\"policyCountersJSON\":\"{\\\"8\\\":\\\"\\\"}\",\"sb_queue\":\"none\",\"sb_e2e\":4462258,\"sb_originHost\":\"tt-b52-pcf91\",\"sb_connectionKey\":1,\"sessionId\":\"tt-b52-pcf91;773394225;1333;942;68\",\"sb_originRealm\":\"5gc.mnc014.mcc232.3gppnetwork.org\",\"subscriptionIdMsisdn\":\"436608795113\",\"policyCounters\":{\"8\":\"\"}}}}","tssysessid":"tt-b52-pcf91;773394225;1333;942;68","tsdpcs":"base","tsdlsvev":"0","tsdptgysybasev":"12941923"},{"objectClass":["TransientVoice"],"latcpd":"Added","labcpd":"INITLOAD","dn":"tsvid=1,pid=436608795113,subs=53540422,acct=H3A,dc=cpd4","tsvid":"1","lawcpd":"1605741898275880"},{"objectClass":["ServiceVOICE"],"dn":"vsid=VOICE,pid=436608795113,subs=53540422,acct=H3A,dc=cpd4","vsid":"VOICE"},{"objectClass":["ServiceVOICE"],"latcpd":"Added","labcpd":"INITLOAD","dn":"vsid=VOICEH3APOST,vsid=VOICE,pid=436608795113,subs=53540422,acct=H3A,dc=cpd4","lawcpd":"1605741922904481","vsid":"VOICEH3APOST"}],"event-type":"ldap"},"description":"handle LDAP","entry":"ldap.status.1000","timestamp":1721994722925,"state":"295","sequence":11,"service":"ocadminv5:h3irs:h3irs_InternationalRoamingService_main","flow":"ocadminv5:h3irs:h3irs_InternationalRoamingService_main"},{"type":"read","fn":"\n/**\n * it is used to implement checks to declare if step was successful or not\n * @param state {Object} state structure, contains at least field session\n * @param event {Object} the event received\n * @return {Boolean} true if step is to be declared successful\n */\nfunction validate(state,event){\n  // it does nothing for now, add your own validation; you have access to state as it was populated from previous steps\n  return true;\n}\n","original-event":{"headers":{"x-fire-and-forget":"no","content-type":"application/json","site-id":"default"},"request-method":"get","body":{"options":{"filter":"(|(sdbKey=436608795113)(sdbKey=436608795113)(sdbKey=43660879511)(sdbKey=4366087951)(sdbKey=436608795)(sdbKey=43660879)(sdbKey=4366087)(sdbKey=436608)(sdbKey=43660)(sdbKey=4366)(sdbKey=436))","time-limit":0,"filter-generator-name":"sdbKey","deref":"never","cache-ttl-ms":0,"scope":"one"},"base-dn":"app=sdbRecord,dc=apd","hierarchical":"false"},"uri":"/search"},"event":{"headers":{"x-fire-and-forget":"no","content-type":"application/json","site-id":"default"},"request-method":"get","body":{"options":{"filter":"(|(sdbKey=436608795113)(sdbKey=436608795113)(sdbKey=43660879511)(sdbKey=4366087951)(sdbKey=436608795)(sdbKey=43660879)(sdbKey=4366087)(sdbKey=436608)(sdbKey=43660)(sdbKey=4366)(sdbKey=436))","time-limit":0,"filter-generator-name":"sdbKey","deref":"never","cache-ttl-ms":0,"scope":"one"},"base-dn":"app=sdbRecord,dc=apd","hierarchical":"false"},"uri":"/search"},"description":"LDAP search","entry":"none","timestamp":1721994722940,"state":"15","sequence":19,"service":"ocadminv5:h3irs:h3irs_InternationalRoamingService_main","flow":"ocadminv5:h3irs:h3irs_H3A_part"},{"type":"write","fn":"\n/**\n * Here you can change the event before it is sent using also the state accumulated so far.\n * @param state {Object} state structure, contains at least field session; you can add to it to propagate state from test step to test step\n * @param event {Object} the event to be sent.\n * @return {Object} the event to be sent\n */\nfunction pre_process(state,event){\n  // it does nothing, it is up to you to add some meaningful actions; most likely you want to change the event before being sent\n  // the application adds session field to event automatically, you don't need to add it\n  return event;\n}\n","event":{"event-name":"ldap.status.1000","headers":{"X-LDAP-backend-pool":"sit","Content-Type":"application/json","X-LDAP-site":"default"},"ingress-queue":"h3irs_LdapClientGW_ingress","status":1000,"body":[{"objectClass":["sdbRecord"],"sdbIMS":"ims.mnc014.mcc232.3gppnetwork.org","labapd":"FIERINA","sdbType":"MOB_OWN","sdbPrimaryNr":"436608795113","latapd":"Updated","sdbNetwork":"POSTPAID","sdbKey":"436608795113","dn":"sdbKey=436608795113,app=sdbRecord,dc=apd","lawapd":"1600240692447853"}],"event-type":"ldap"},"original-event":{"event-name":"ldap.status.1000","headers":{"X-LDAP-backend-pool":"sit","Content-Type":"application/json","X-LDAP-site":"default"},"ingress-queue":"h3irs_LdapClientGW_ingress","status":1000,"body":[{"objectClass":["sdbRecord"],"sdbIMS":"ims.mnc014.mcc232.3gppnetwork.org","labapd":"FIERINA","sdbType":"MOB_OWN","sdbPrimaryNr":"436608795113","latapd":"Updated","sdbNetwork":"POSTPAID","sdbKey":"436608795113","dn":"sdbKey=436608795113,app=sdbRecord,dc=apd","lawapd":"1600240692447853"}],"event-type":"ldap"},"description":"Get and Check","entry":"ldap.status.1000","timestamp":1721994722960,"state":"39","sequence":20,"service":"ocadminv5:h3irs:h3irs_InternationalRoamingService_main","flow":"ocadminv5:h3irs:h3irs_H3A_part"},{"type":"read","fn":"\n/**\n * it is used to implement checks to declare if step was successful or not\n * @param state {Object} state structure, contains at least field session\n * @param event {Object} the event received\n * @return {Boolean} true if step is to be declared successful\n */\nfunction validate(state,event){\n  // it does nothing for now, add your own validation; you have access to state as it was populated from previous steps\n  return true;\n}\n","original-event":{"headers":{"x-fire-and-forget":"no","content-type":"application/json","site-id":"default"},"request-method":"get","body":{"options":{"filter":"(|(dontrange=43660303256)(dontrange=43660303256)(dontrange=4366030325)(dontrange=436603032)(dontrange=43660303)(dontrange=4366030)(dontrange=436603)(dontrange=43660)(dontrange=4366)(dontrange=436))","time-limit":0,"filter-generator-name":"dontrange","deref":"never","cache-ttl-ms":0,"scope":"one"},"base-dn":"app=dontreroute,dc=apd","hierarchical":"false"},"uri":"/search"},"event":{"headers":{"x-fire-and-forget":"no","content-type":"application/json","site-id":"default"},"request-method":"get","body":{"options":{"filter":"(|(dontrange=43660303256)(dontrange=43660303256)(dontrange=4366030325)(dontrange=436603032)(dontrange=43660303)(dontrange=4366030)(dontrange=436603)(dontrange=43660)(dontrange=4366)(dontrange=436))","time-limit":0,"filter-generator-name":"dontrange","deref":"never","cache-ttl-ms":0,"scope":"one"},"base-dn":"app=dontreroute,dc=apd","hierarchical":"false"},"uri":"/search"},"description":"LDAP search","entry":"none","timestamp":1721994722982,"state":"442","sequence":32,"service":"ocadminv5:h3irs:h3irs_InternationalRoamingService_main","flow":"ocadminv5:h3irs:h3irs_H3A_MOSetup"},{"type":"write","fn":"\n/**\n * Here you can change the event before it is sent using also the state accumulated so far.\n * @param state {Object} state structure, contains at least field session; you can add to it to propagate state from test step to test step\n * @param event {Object} the event to be sent.\n * @return {Object} the event to be sent\n */\nfunction pre_process(state,event){\n  // it does nothing, it is up to you to add some meaningful actions; most likely you want to change the event before being sent\n  // the application adds session field to event automatically, you don't need to add it\n  return event;\n}\n","event":{"event-name":"ldap.status.1000","headers":{"X-LDAP-backend-pool":"sit","Content-Type":"application/json","X-LDAP-site":"default"},"ingress-queue":"h3irs_LdapClientGW_ingress","status":1000,"body":[],"event-type":"ldap"},"original-event":{"event-name":"ldap.status.1000","headers":{"X-LDAP-backend-pool":"sit","Content-Type":"application/json","X-LDAP-site":"default"},"ingress-queue":"h3irs_LdapClientGW_ingress","status":1000,"body":[],"event-type":"ldap"},"description":"Check","entry":"ldap.status.1000","timestamp":1721994723233,"state":"443","sequence":33,"service":"ocadminv5:h3irs:h3irs_InternationalRoamingService_main","flow":"ocadminv5:h3irs:h3irs_H3A_MOSetup"},{"type":"read","fn":"\n/**\n * it is used to implement checks to declare if step was successful or not\n * @param state {Object} state structure, contains at least field session\n * @param event {Object} the event received\n * @return {Boolean} true if step is to be declared successful\n */\nfunction validate(state,event){\n  // it does nothing for now, add your own validation; you have access to state as it was populated from previous steps\n    state[\"MSRN\"] = event[\"action\"][\"uri\"][\"user\"];\n    //java.lang.Thread.sleep(9999);\n    if (event[\"action\"][\"uri\"][\"user\"].startsWith(\"436603038\"))\n    return true;\n  else\n    return false;\n\n}\n","original-event":{"event-name":"tas.cap.leaveCall","as":null,"id":0,"callid":"tt-b52-vtas3-seese-0003_3-1719301480904-CALL-1-AppSess-202","action":{"type":4,"uri":{"scheme":"tel","user":"43660303818590","parameters":{"network-context":"Q763.4.1"}}},"eventname":"callStart","event-type":"tas-cap"},"event":{"event-name":"tas.cap.leaveCall","as":null,"id":0,"callid":"tt-b52-vtas3-seese-0003_3-1719301480904-CALL-1-AppSess-202","action":{"type":4,"uri":{"scheme":"tel","user":"43660303818590","parameters":{"network-context":"Q763.4.1"}}},"eventname":"callStart","event-type":"tas-cap"},"description":"Leave call","entry":"success","timestamp":1721994723254,"state":"249","sequence":40,"service":"ocadminv5:h3irs:h3irs_InternationalRoamingService_main","flow":"ocadminv5:h3irs:h3irs_H3A_MOSetup","useScript":true},{"type":"write","fn":"\n/**\n * Here you can change the event before it is sent using also the state accumulated so far.\n * @param state {Object} state structure, contains at least field session; you can add to it to propagate state from test step to test step\n * @param event {Object} the event to be sent.\n * @return {Object} the event to be sent\n */\nfunction pre_process(state,event){\n  // it does nothing, it is up to you to add some meaningful actions; most likely you want to change the event before being sent\n  // the application adds session field to event automatically, you don't need to add it\n  //event[\"event\"][\"callStart\"][\"contact\"] = 2433535353;\n\n  event[\"session\"]=\"PMSRNroute_\" + state[\"MSRN\"];\n  event[\"event\"][\"callStart\"][\"contact\"] = \"tel:+\" + state[\"MSRN\"];\n  event[\"SIP\"][\"R-URI\"][\"value\"] = \"tel:+\" + state[\"MSRN\"];\n  event[\"SIP\"][\"R-URI\"][\"address\"][\"uri\"][\"number\"] =  state[\"MSRN\"];\n  \n  return event;\n}\n","event":{"event-name":"sip.callStart.NONE","call":{"legs":[{"name":"Uas","address":"tel:+4369911706666"}],"state":"START"},"as":"tt-b52-vtas3-seese-0003_2","SIP":{"capabilities":["FORKING","HISTORY_INFO","UPDATE","REL1XX","PEM"],"From":{"header":"From","address":{"uri":{"scheme":"tel","number":"4369911706666"},"uriValue":"tel:+4369911706666"},"tag":"9OaZxDoV_0KCf-18637-2204-7-17","value":"<tel:+4369911706666>;tag=9OaZxDoV_0KCf-18637-2204-7-17"},"R-URI":{"header":"RURI","value":"tel:+43660303817286","address":{"uri":{"scheme":"tel","number":"43660303817286"}}},"Supported":{"header":"Supported","value":["timer","100rel","histinfo","join","norefersub","replaces"]},"content":{"Content-SubType":"mixed","Content-Type":"multipart"},"Route":[{"header":"Route","value":"<sip:irs.sit.vtas.as.drei.at;lr;mode=mo>","address":{"uri":{"host":"irs.sit.vtas.as.drei.at","scheme":"sip","port":-1,"parameters":{"mode":"mo","lr":""},"lr":"true","authority":"irs.sit.vtas.as.drei.at"},"uriValue":"sip:irs.sit.vtas.as.drei.at;lr;mode=mo"}},{"header":"Route","value":"<sip:zteodi001400010BD0047100E009ED0213891E@172.20.208.8:5060;lr>","address":{"uri":{"scheme":"sip","port":5060,"lr":"true","authority":"zteodi001400010BD0047100E009ED0213891E@172.20.208.8:5060","host":"172.20.208.8","user":"zteodi001400010BD0047100E009ED0213891E","parameters":{"lr":""}},"uriValue":"sip:zteodi001400010BD0047100E009ED0213891E@172.20.208.8:5060;lr"}}],"Privacy":{"header":"Privacy","privacy":"none","value":"none"},"P-Asserted-Identity":[{"header":"P-Asserted-Identity","value":"<tel:+4369911706666>","address":{"uri":{"scheme":"tel","number":"4369911706666"},"uriValue":"tel:+4369911706666"}}],"mime":[{"json":{"presence":{"xmlns:caps":"urn:ietf:params:xml:ns:pidf:caps","xmlns:cl":"urn:ietf:params:xml:ns:pidf:geopriv10:civicLoc","xmlns:op":"urn:oma:xml:prs:pidf:oma-pres","xmlns:gp":"urn:ietf:params:xml:ns:pidf:geopriv10","xmlns:con":"urn:ietf:params:xml:ns:geopriv:conf","tuple":{"status":{"gp:geopriv":{"gp:method":"FUSED","gp:location-info":{"cl:civicAddress":{"cl:PC":"2020","cl:A6":"Eduard MÃ¼ller Gasse","cl:country":"AT","cl:A1":"NiederÃ¶sterreich","cl:HNO":"10","cl:A3":"Hollabrunn"},"gs:Circle":{"gml:pos":"48.5606809 16.0856604","xmlns:gs":"http://www.opengis.net/pidflo/1.0","srsName":"urn:ogc:def:crs:EPSG::4326","gs:radius":{"uom":"urn:ogc:def:uom:EPSG::9001","content":"20.0"}},"con:confidence":{"content":"68","pdf":"normal"}},"gp:usage-rules":{"gp:retention-expiry":"2023-09-01T06:14:18.01Z","gp:retransmission-allowed":"no"}}},"timestamp":"2023-08-31T08:19:49Z"},"xmlns":"urn:ietf:params:xml:ns:pidf","xmlns:gml":"urn:opengis:specification:gml:schema-xsd:feature:v3.0","xmlns:rpid":"urn:ietf:params:xml:ns:pidf:rpid","xmlns:pdm":"urn:ietf:params:xml:ns:pidf:data-model","entity":"+4366066082231@ims.mnc005.mcc232.3gppnetwork.org","xmlns:c":"urn:ietf:params:xml:ns:pidf:cipid"}},"Content-SubType":"pidf+xml","Content-Type":"application"},{"json":{"session":"SS VOIP","media":[{"bandwidth":[{"bwtype":"AS","type":"AS","bandwidth":42,"value":42},{"bwtype":"RS","type":"RS","bandwidth":0,"value":0},{"bwtype":"RR","type":"RR","bandwidth":2500,"value":2500}],"attributes":[{"name":"rtpmap","value":"112 EVS/16000"},{"name":"fmtp","value":"112 br=5.9-24.4;bw=nb-swb;ch-aw-recv=-1"},{"name":"rtpmap","value":"116 AMR-WB/16000/1"},{"name":"fmtp","value":"116 mode-change-capability=2;max-red=220"},{"name":"rtpmap","value":"118 AMR/8000/1"},{"name":"fmtp","value":"118 mode-change-capability=2;max-red=220"},{"name":"rtpmap","value":"111 telephone-event/16000"},{"name":"fmtp","value":"111 0-15"},{"name":"rtpmap","value":"110 telephone-event/8000"},{"name":"fmtp","value":"110 0-15"},{"name":"sendrecv","value":null},{"name":"ptime","value":"20"},{"name":"maxptime","value":"240"}]}]},"Content-SubType":"sdp","Content-Type":"application"}],"Allow":{"header":"Allow","value":["REGISTER","INVITE","ACK","CANCEL","BYE","OPTIONS","UPDATE","PRACK","REFER","INFO","NOTIFY","MESSAGE","SUBSCRIBE"]},"P-Access-Network-Info":{"accessType":"GPP-UTRAN","header":"P-Access-Network-Info","cellId":"27601f30d402bd","params":{"cs":"","utran_cell_id_3gpp":"27601f30d402bd"},"value":"GPP-UTRAN; utran-cell-id-3gpp=27601f30d402bd;CS"},"Call-ID":{"header":"Call-ID","value":"1-28246@172.23.11.2"},"To":{"header":"To","value":"<tel:+43660303817286>","address":{"uri":{"scheme":"tel","number":"43660303817286"},"uriValue":"tel:+43660303817286"}},"P-Early-Media":{"header":"P-Early-Media","value":"supported"},"message":{"method":["INVITE"],"type":["Request"],"body":["INVITE tel:+43660303817286 SIP/2.0\r\nMax-Forwards: 10\r\nVia: SIP/2.0/UDP 172.20.208.3;branch=z9hG4bKb341.fea376351b49c0a7ee43823836901e93.0;rport=5060;received=172.20.208.3,SIP/2.0/UDP 172.20.208.42:5060;received=172.20.208.21;branch=z9hG4bK-28246-1-0\r\nTo: <tel:+43660303817286>\r\nFrom: <tel:+4369911706666>;tag=9OaZxDoV_0KCf-18637-2204-7-17\r\nCall-ID: 1-28246@172.23.11.2\r\nCSeq: 1 INVITE\r\nPrivacy: none\r\nContact: <sip:213.94.126.176:5060>\r\nP-Asserted-Identity: <tel:+4369911706666>\r\nP-Access-Network-Info: GPP-UTRAN; utran-cell-id-3gpp=27601f30d402bd;CS\r\nP-Early-Media: supported\r\nRoute: <sip:irs.sit.vtas.as.drei.at;lr;mode=mo>,<sip:zteodi001400010BD0047100E009ED0213891E@172.20.208.8:5060;lr>\r\nAllow: REGISTER,INVITE,ACK,CANCEL,BYE,OPTIONS,UPDATE,PRACK,REFER,INFO,NOTIFY,MESSAGE,SUBSCRIBE\r\nAccept: application/sdp,multipart/mixed\r\nSupported: timer,100rel,histinfo,join,norefersub,replaces\r\nUser-Agent: SM-S906B-WH5 Samsung IMS 6.0\r\nSession-Expires: 1800\r\nMin-SE: 600\r\nAccept-Contact: *;+g.3gpp.icsi-ref=\"urn%3Aurn-7%3A3gpp-service.ims.icsi.mmtel\"\r\nP-Preferred-Service: urn:urn-7:3gpp-service.ims.icsi.mmtel\r\nContent-Type: multipart/mixed;boundary=4be227062af3zte\r\nContent-Length: 2239\r\n\r\n--4be227062af3zte\r\nContent-Type: application/pidf+xml\r\nContent-ID: <+4366066082231@ims.mnc005.mcc232.3gppnetwork.org>\r\n\r\n<?xml version=\"1.0\" encoding=\"UTF-8\"?>\r\n<presence entity=\"+4366066082231@ims.mnc005.mcc232.3gppnetwork.org\" xmlns=\"urn:ietf:params:xml:ns:pidf\" xmlns:c=\"urn:ietf:params:xml:ns:pidf:cipid\" xmlns:caps=\"urn:ietf:params:xml:ns:pidf:caps\" xmlns:cl=\"urn:ietf:params:xml:ns:pidf:geopriv10:civicLoc\" xmlns:con=\"urn:ietf:params:xml:ns:geopriv:conf\" xmlns:gml=\"urn:opengis:specification:gml:schema-xsd:feature:v3.0\" xmlns:gp=\"urn:ietf:params:xml:ns:pidf:geopriv10\" xmlns:op=\"urn:oma:xml:prs:pidf:oma-pres\" xmlns:pdm=\"urn:ietf:params:xml:ns:pidf:data-model\" xmlns:rpid=\"urn:ietf:params:xml:ns:pidf:rpid\">\r\n<tuple>\r\n<status>\r\n<gp:geopriv>\r\n<gp:location-info>\r\n<gs:Circle srsName=\"urn:ogc:def:crs:EPSG::4326\" xmlns:gs=\"http://www.opengis.net/pidflo/1.0\">\r\n<gml:pos>48.5606809 16.0856604</gml:pos>\r\n<gs:radius uom=\"urn:ogc:def:uom:EPSG::9001\">20.0</gs:radius>\r\n</gs:Circle>\r\n<con:confidence pdf=\"normal\">68</con:confidence>\r\n<cl:civicAddress>\r\n<cl:country>AT</cl:country>\r\n<cl:A1>NiederÃ¶sterreich</cl:A1>\r\n<cl:A3>Hollabrunn</cl:A3>\r\n<cl:A6>Eduard MÃ¼ller Gasse</cl:A6>\r\n<cl:HNO>10</cl:HNO>\r\n<cl:PC>2020</cl:PC>\r\n</cl:civicAddress>\r\n</gp:location-info>\r\n<gp:usage-rules>\r\n<gp:retransmission-allowed>no</gp:retransmission-allowed>\r\n<gp:retention-expiry>2023-09-01T06:14:18.01Z</gp:retention-expiry>\r\n</gp:usage-rules>\r\n<gp:method>FUSED</gp:method>\r\n</gp:geopriv>\r\n</status>\r\n<timestamp>2023-08-31T08:19:49Z</timestamp>\r\n</tuple>\r\n</presence>\r\n\r\n--4be227062af3zte\r\nContent-Type: application/sdp\r\nContent-Disposition: session\r\nContent-Length: 558\r\n\r\nv=0\r\no=SAMSUNG-IMS-UE 4720264596 871368456 IN IP4 172.20.165.30\r\ns=SS VOIP\r\nc=IN IP4 172.20.165.30\r\nt=0 0\r\nm=audio 29866 RTP/AVP 112 116 118 8 0 18 4 9 111 110\r\nb=AS:42\r\nb=RS:0\r\nb=RR:2500\r\na=rtpmap:112 EVS/16000\r\na=fmtp:112 br=5.9-24.4;bw=nb-swb;ch-aw-recv=-1\r\na=rtpmap:116 AMR-WB/16000/1\r\na=fmtp:116 mode-change-capability=2;max-red=220\r\na=rtpmap:118 AMR/8000/1\r\na=fmtp:118 mode-change-capability=2;max-red=220\r\na=rtpmap:111 telephone-event/16000\r\na=fmtp:111 0-15\r\na=rtpmap:110 telephone-event/8000\r\na=fmtp:110 0-15\r\na=sendrecv\r\na=ptime:20\r\na=maxptime:240\r\n\r\n--4be227062af3zte--\r\n"]},"Contact":{"qvalue":-1,"header":"Contact","expires":-1,"address":{"uri":{"host":"213.94.126.176","scheme":"sip","port":5060,"authority":"213.94.126.176:5060"},"uriValue":"sip:213.94.126.176:5060"},"value":"<sip:213.94.126.176:5060>","wildcard":false},"Record-Route":[],"CSeq":{"header":"CSeq","seqNumber":1,"method":"INVITE","value":1}},"header":{"overloadedLateEvent":1214123751},"note":"replace 4369911706666 with the real PMSRN","event":{"name":"callStart","callStart":{"cause":"NONE","contact":"tel:+43660303817286","leg":"tel:+4369911706666"},"id":0},"events-stack":["sip.callStart.NONE"],"callid":"tt-b52-vtas3-seese-0003_2;1-28246@172.23.11.2","starttime":1720780101482,"event-type":"sip"},"original-event":{"event-name":"sip.callStart.NONE","event-label":"h3irs_staging","call":{"legs":[{"name":"Uas","address":"tel:+4369911706666"}],"state":"START"},"as":"tt-b52-vtas3-seese-0003_2","event-additional-info":{"tracingmsg":"IRSbyPAIUser","tracinglist":"h3irs_staging","dispatcherresult":"stagingset","tracingid":"4369911706666","traceIndented":false},"SIP":{"capabilities":["FORKING","HISTORY_INFO","UPDATE","REL1XX","PEM"],"From":{"header":"From","address":{"uri":{"scheme":"tel","number":"4369911706666"},"uriValue":"tel:+4369911706666"},"tag":"9OaZxDoV_0KCf-18637-2204-7-17","value":"<tel:+4369911706666>;tag=9OaZxDoV_0KCf-18637-2204-7-17"},"R-URI":{"header":"RURI","value":"tel:+43660303817286","address":{"uri":{"scheme":"tel","number":"43660303817286"}}},"Supported":{"header":"Supported","value":["timer","100rel","histinfo","join","norefersub","replaces"]},"content":{"Content-SubType":"mixed","Content-Type":"multipart"},"Route":[{"header":"Route","value":"<sip:irs.sit.vtas.as.drei.at;lr;mode=mo>","address":{"uri":{"host":"irs.sit.vtas.as.drei.at","scheme":"sip","port":-1,"parameters":{"mode":"mo","lr":""},"lr":"true","authority":"irs.sit.vtas.as.drei.at"},"uriValue":"sip:irs.sit.vtas.as.drei.at;lr;mode=mo"}},{"header":"Route","value":"<sip:zteodi001400010BD0047100E009ED0213891E@172.20.208.8:5060;lr>","address":{"uri":{"scheme":"sip","port":5060,"lr":"true","authority":"zteodi001400010BD0047100E009ED0213891E@172.20.208.8:5060","host":"172.20.208.8","user":"zteodi001400010BD0047100E009ED0213891E","parameters":{"lr":""}},"uriValue":"sip:zteodi001400010BD0047100E009ED0213891E@172.20.208.8:5060;lr"}}],"Privacy":{"header":"Privacy","privacy":"none","value":"none"},"P-Asserted-Identity":[{"header":"P-Asserted-Identity","value":"<tel:+4369911706666>","address":{"uri":{"scheme":"tel","number":"4369911706666"},"uriValue":"tel:+4369911706666"}}],"mime":[{"json":{"presence":{"xmlns:caps":"urn:ietf:params:xml:ns:pidf:caps","xmlns:cl":"urn:ietf:params:xml:ns:pidf:geopriv10:civicLoc","xmlns:op":"urn:oma:xml:prs:pidf:oma-pres","xmlns:gp":"urn:ietf:params:xml:ns:pidf:geopriv10","xmlns:con":"urn:ietf:params:xml:ns:geopriv:conf","tuple":{"status":{"gp:geopriv":{"gp:method":"FUSED","gp:location-info":{"cl:civicAddress":{"cl:PC":"2020","cl:A6":"Eduard MÃ¼ller Gasse","cl:country":"AT","cl:A1":"NiederÃ¶sterreich","cl:HNO":"10","cl:A3":"Hollabrunn"},"gs:Circle":{"gml:pos":"48.5606809 16.0856604","xmlns:gs":"http://www.opengis.net/pidflo/1.0","srsName":"urn:ogc:def:crs:EPSG::4326","gs:radius":{"uom":"urn:ogc:def:uom:EPSG::9001","content":"20.0"}},"con:confidence":{"content":"68","pdf":"normal"}},"gp:usage-rules":{"gp:retention-expiry":"2023-09-01T06:14:18.01Z","gp:retransmission-allowed":"no"}}},"timestamp":"2023-08-31T08:19:49Z"},"xmlns":"urn:ietf:params:xml:ns:pidf","xmlns:gml":"urn:opengis:specification:gml:schema-xsd:feature:v3.0","xmlns:rpid":"urn:ietf:params:xml:ns:pidf:rpid","xmlns:pdm":"urn:ietf:params:xml:ns:pidf:data-model","entity":"+4366066082231@ims.mnc005.mcc232.3gppnetwork.org","xmlns:c":"urn:ietf:params:xml:ns:pidf:cipid"}},"Content-SubType":"pidf+xml","Content-Type":"application"},{"json":{"session":"SS VOIP","media":[{"bandwidth":[{"bwtype":"AS","type":"AS","bandwidth":42,"value":42},{"bwtype":"RS","type":"RS","bandwidth":0,"value":0},{"bwtype":"RR","type":"RR","bandwidth":2500,"value":2500}],"attributes":[{"name":"rtpmap","value":"112 EVS/16000"},{"name":"fmtp","value":"112 br=5.9-24.4;bw=nb-swb;ch-aw-recv=-1"},{"name":"rtpmap","value":"116 AMR-WB/16000/1"},{"name":"fmtp","value":"116 mode-change-capability=2;max-red=220"},{"name":"rtpmap","value":"118 AMR/8000/1"},{"name":"fmtp","value":"118 mode-change-capability=2;max-red=220"},{"name":"rtpmap","value":"111 telephone-event/16000"},{"name":"fmtp","value":"111 0-15"},{"name":"rtpmap","value":"110 telephone-event/8000"},{"name":"fmtp","value":"110 0-15"},{"name":"sendrecv","value":null},{"name":"ptime","value":"20"},{"name":"maxptime","value":"240"}]}]},"Content-SubType":"sdp","Content-Type":"application"}],"Allow":{"header":"Allow","value":["REGISTER","INVITE","ACK","CANCEL","BYE","OPTIONS","UPDATE","PRACK","REFER","INFO","NOTIFY","MESSAGE","SUBSCRIBE"]},"P-Access-Network-Info":{"accessType":"GPP-UTRAN","header":"P-Access-Network-Info","cellId":"27601f30d402bd","params":{"cs":"","utran_cell_id_3gpp":"27601f30d402bd"},"value":"GPP-UTRAN; utran-cell-id-3gpp=27601f30d402bd;CS"},"Call-ID":{"header":"Call-ID","value":"1-28246@172.23.11.2"},"To":{"header":"To","value":"<tel:+43660303817286>","address":{"uri":{"scheme":"tel","number":"43660303817286"},"uriValue":"tel:+43660303817286"}},"P-Early-Media":{"header":"P-Early-Media","value":"supported"},"message":{"method":["INVITE"],"type":["Request"],"body":["INVITE tel:+43660303817286 SIP/2.0\r\nMax-Forwards: 10\r\nVia: SIP/2.0/UDP 172.20.208.3;branch=z9hG4bKb341.fea376351b49c0a7ee43823836901e93.0;rport=5060;received=172.20.208.3,SIP/2.0/UDP 172.20.208.42:5060;received=172.20.208.21;branch=z9hG4bK-28246-1-0\r\nTo: <tel:+43660303817286>\r\nFrom: <tel:+4369911706666>;tag=9OaZxDoV_0KCf-18637-2204-7-17\r\nCall-ID: 1-28246@172.23.11.2\r\nCSeq: 1 INVITE\r\nPrivacy: none\r\nContact: <sip:213.94.126.176:5060>\r\nP-Asserted-Identity: <tel:+4369911706666>\r\nP-Access-Network-Info: GPP-UTRAN; utran-cell-id-3gpp=27601f30d402bd;CS\r\nP-Early-Media: supported\r\nRoute: <sip:irs.sit.vtas.as.drei.at;lr;mode=mo>,<sip:zteodi001400010BD0047100E009ED0213891E@172.20.208.8:5060;lr>\r\nAllow: REGISTER,INVITE,ACK,CANCEL,BYE,OPTIONS,UPDATE,PRACK,REFER,INFO,NOTIFY,MESSAGE,SUBSCRIBE\r\nAccept: application/sdp,multipart/mixed\r\nSupported: timer,100rel,histinfo,join,norefersub,replaces\r\nUser-Agent: SM-S906B-WH5 Samsung IMS 6.0\r\nSession-Expires: 1800\r\nMin-SE: 600\r\nAccept-Contact: *;+g.3gpp.icsi-ref=\"urn%3Aurn-7%3A3gpp-service.ims.icsi.mmtel\"\r\nP-Preferred-Service: urn:urn-7:3gpp-service.ims.icsi.mmtel\r\nContent-Type: multipart/mixed;boundary=4be227062af3zte\r\nContent-Length: 2239\r\n\r\n--4be227062af3zte\r\nContent-Type: application/pidf+xml\r\nContent-ID: <+4366066082231@ims.mnc005.mcc232.3gppnetwork.org>\r\n\r\n<?xml version=\"1.0\" encoding=\"UTF-8\"?>\r\n<presence entity=\"+4366066082231@ims.mnc005.mcc232.3gppnetwork.org\" xmlns=\"urn:ietf:params:xml:ns:pidf\" xmlns:c=\"urn:ietf:params:xml:ns:pidf:cipid\" xmlns:caps=\"urn:ietf:params:xml:ns:pidf:caps\" xmlns:cl=\"urn:ietf:params:xml:ns:pidf:geopriv10:civicLoc\" xmlns:con=\"urn:ietf:params:xml:ns:geopriv:conf\" xmlns:gml=\"urn:opengis:specification:gml:schema-xsd:feature:v3.0\" xmlns:gp=\"urn:ietf:params:xml:ns:pidf:geopriv10\" xmlns:op=\"urn:oma:xml:prs:pidf:oma-pres\" xmlns:pdm=\"urn:ietf:params:xml:ns:pidf:data-model\" xmlns:rpid=\"urn:ietf:params:xml:ns:pidf:rpid\">\r\n<tuple>\r\n<status>\r\n<gp:geopriv>\r\n<gp:location-info>\r\n<gs:Circle srsName=\"urn:ogc:def:crs:EPSG::4326\" xmlns:gs=\"http://www.opengis.net/pidflo/1.0\">\r\n<gml:pos>48.5606809 16.0856604</gml:pos>\r\n<gs:radius uom=\"urn:ogc:def:uom:EPSG::9001\">20.0</gs:radius>\r\n</gs:Circle>\r\n<con:confidence pdf=\"normal\">68</con:confidence>\r\n<cl:civicAddress>\r\n<cl:country>AT</cl:country>\r\n<cl:A1>NiederÃ¶sterreich</cl:A1>\r\n<cl:A3>Hollabrunn</cl:A3>\r\n<cl:A6>Eduard MÃ¼ller Gasse</cl:A6>\r\n<cl:HNO>10</cl:HNO>\r\n<cl:PC>2020</cl:PC>\r\n</cl:civicAddress>\r\n</gp:location-info>\r\n<gp:usage-rules>\r\n<gp:retransmission-allowed>no</gp:retransmission-allowed>\r\n<gp:retention-expiry>2023-09-01T06:14:18.01Z</gp:retention-expiry>\r\n</gp:usage-rules>\r\n<gp:method>FUSED</gp:method>\r\n</gp:geopriv>\r\n</status>\r\n<timestamp>2023-08-31T08:19:49Z</timestamp>\r\n</tuple>\r\n</presence>\r\n\r\n--4be227062af3zte\r\nContent-Type: application/sdp\r\nContent-Disposition: session\r\nContent-Length: 558\r\n\r\nv=0\r\no=SAMSUNG-IMS-UE 4720264596 871368456 IN IP4 172.20.165.30\r\ns=SS VOIP\r\nc=IN IP4 172.20.165.30\r\nt=0 0\r\nm=audio 29866 RTP/AVP 112 116 118 8 0 18 4 9 111 110\r\nb=AS:42\r\nb=RS:0\r\nb=RR:2500\r\na=rtpmap:112 EVS/16000\r\na=fmtp:112 br=5.9-24.4;bw=nb-swb;ch-aw-recv=-1\r\na=rtpmap:116 AMR-WB/16000/1\r\na=fmtp:116 mode-change-capability=2;max-red=220\r\na=rtpmap:118 AMR/8000/1\r\na=fmtp:118 mode-change-capability=2;max-red=220\r\na=rtpmap:111 telephone-event/16000\r\na=fmtp:111 0-15\r\na=rtpmap:110 telephone-event/8000\r\na=fmtp:110 0-15\r\na=sendrecv\r\na=ptime:20\r\na=maxptime:240\r\n\r\n--4be227062af3zte--\r\n"]},"Contact":{"qvalue":-1,"header":"Contact","expires":-1,"address":{"uri":{"host":"213.94.126.176","scheme":"sip","port":5060,"authority":"213.94.126.176:5060"},"uriValue":"sip:213.94.126.176:5060"},"value":"<sip:213.94.126.176:5060>","wildcard":false},"Record-Route":[],"CSeq":{"header":"CSeq","seqNumber":1,"method":"INVITE","value":1}},"header":{"overloadedLateEvent":1214123751},"note":"replace 4369911706666 with the real PMSRN","event":{"name":"callStart","callStart":{"cause":"NONE","contact":"tel:+43660303817286","leg":"tel:+4369911706666"},"id":0},"event-label-match":false,"events-stack":["sip.callStart.NONE"],"callid":"tt-b52-vtas3-seese-0003_2;1-28246@172.23.11.2","starttime":1720780101482,"event-type":"sip"},"description":"","entry":"sip.callStart.NONE","timestamp":1721994225236,"state":"114","sequence":1,"service":"ocadminv5:h3irs:h3irs_InternationalRoamingService_main","flow":"ocadminv5:h3irs:h3irs_InternationalRoamingService_main","useScript":true},{"type":"read","fn":"\n/**\n * it is used to implement checks to declare if step was successful or not\n * @param state {Object} state structure, contains at least field session\n * @param event {Object} the event received\n * @return {Boolean} true if step is to be declared successful\n */\nfunction validate(state,event){\n  // it does nothing for now, add your own validation; you have access to state as it was populated from previous steps\n  return true;\n}\n","original-event":{"headers":{"content-type":"application/json"},"no-reply":true,"request-method":"post","body":{"template":"default","library":"io.qsrlabs.nexus.diameter.gui.handlers","body":{"irs":{},"a_country":"Vodafone Italia S.p.A","queue":"cdrQueue","a_pai":"4369911706666","a_location":"22210","a_idp":"436608795113","a_date":"Fri Jul 26 2024 13:43:45 GMT+0200 (CEST)","a_present":"0","a_from":"4369911706666","a_privacy":"none","a_callid":"tt-b52-vtas3-seese-0003_2;1-28246@172.23.11.2"},"function":"file-cdr-request"},"uri":"/file-cdr-request"},"event":{"headers":{"content-type":"application/json"},"no-reply":true,"request-method":"post","body":{"template":"default","library":"io.qsrlabs.nexus.diameter.gui.handlers","body":{"irs":{},"a_country":"Vodafone Italia S.p.A","queue":"cdrQueue","a_pai":"4369911706666","a_location":"22210","a_idp":"436608795113","a_date":"Fri Jul 26 2024 13:43:45 GMT+0200 (CEST)","a_present":"0","a_from":"4369911706666","a_privacy":"none","a_callid":"tt-b52-vtas3-seese-0003_2;1-28246@172.23.11.2"},"function":"file-cdr-request"},"uri":"/file-cdr-request"},"description":"Generate file CDR","entry":"success","timestamp":1721994225281,"state":"449","sequence":12,"service":"ocadminv5:h3irs:h3irs_InternationalRoamingService_main","flow":"ocadminv5:h3irs:h3irs_H3A_SIP_part"},{"type":"read","fn":"\n/**\n * it is used to implement checks to declare if step was successful or not\n * @param state {Object} state structure, contains at least field session\n * @param event {Object} the event received\n * @return {Boolean} true if step is to be declared successful\n */\nfunction validate(state,event){\n  // it does nothing for now, add your own validation; you have access to state as it was populated from previous steps\n    if (event[\"headerrulevar\"][\"xVtasIRS\"].startsWith(\"irs;roampartnername=\\\"Vodafone Italia S.p.A\\\";roamccndc=39349;roammccmnc=22210;reroutingnumber=4366030\"))\n    return true;\n  else\n    return false;\n\n}\n","original-event":{"event-name":"sip.leaveCall","headerrulevar":{"xVtasIRS":"irs;roampartnername=\"Vodafone Italia S.p.A\";roamccndc=39349;roammccmnc=22210;reroutingnumber=43660303817286","psu":"<tel:+436608795113>","newPai":"<tel:+436608795113>","xVtasRoute":"irsRoute","disableSendDefaultReason":"Disabled","pani":"3GPP-UTRAN;utran-cell-id-3gpp=22210f4e733ebd;CS","disableSendNoAnswerReason":"Disabled","newFrom":"<tel:+436608795113>;tag=9OaZxDoV_0KCf-18637-2204-7-17"},"events":{"SIPRingingPollEvent":"null","RawContentPollEvent":"test/test","InfoPollEvent":"null","SuccessResponsePollEvent":"null"},"id":0,"headerrulesselect":"SipServiceSpecificRulesSet","callid":"tt-b52-vtas3-seese-0003_2;1-28246@172.23.11.2","action":{"leaveType":"proxy","type":3,"uri":"tel:+43660303256"},"eventname":"callStart","event-type":"sip"},"event":{"event-name":"sip.leaveCall","headerrulevar":{"xVtasIRS":"irs;roampartnername=\"Vodafone Italia S.p.A\";roamccndc=39349;roammccmnc=22210;reroutingnumber=43660303817286","psu":"<tel:+436608795113>","newPai":"<tel:+436608795113>","xVtasRoute":"irsRoute","disableSendDefaultReason":"Disabled","pani":"3GPP-UTRAN;utran-cell-id-3gpp=22210f4e733ebd;CS","disableSendNoAnswerReason":"Disabled","newFrom":"<tel:+436608795113>;tag=9OaZxDoV_0KCf-18637-2204-7-17"},"events":{"SIPRingingPollEvent":"null","RawContentPollEvent":"test/test","InfoPollEvent":"null","SuccessResponsePollEvent":"null"},"id":0,"headerrulesselect":"SipServiceSpecificRulesSet","callid":"tt-b52-vtas3-seese-0003_2;1-28246@172.23.11.2","action":{"leaveType":"proxy","type":3,"uri":"tel:+43660303256"},"eventname":"callStart","event-type":"sip"},"description":"Leave call","entry":"sent.ok","timestamp":1721994225290,"state":"150","sequence":13,"service":"ocadminv5:h3irs:h3irs_InternationalRoamingService_main","flow":"ocadminv5:h3irs:h3irs_H3A_SIP_part","useScript":true}],"flow":"h3irs_InternationalRoamingService_main","state":{},"description":"This is a merged IRS CAP reroute and SIP invite case. Manually merged the steps and added the \"handover\" of the MSRN to fetch the correct context in the SIP received call","tags":"RTEv5,CAPandSIP,Success,CDR"}